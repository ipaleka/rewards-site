{% load i18n static allauth account %}

<h3 class="text-lg font-semibold mb-3">{{ method }} with Algorand Wallet</h3>
<div class="p-4 rounded-lg bg-base-200 mb-6">
  <div id="app" class="space-y-4">
    <div id="active-network" data-network="{{ active_network|default:'testnet' }}">
      <div class="space-y-3">
        <h4 class="font-semibold text-lg">
          Current Network:
          <span class="badge badge-outline">{{ active_network|default:"testnet" }}</span>
        </h4>

        <div class="flex gap-2">
          <button type="button" data-network="testnet"
                  class="btn btn-outline btn-sm {% if active_network == 'testnet' %}disabled{% endif %}">
            Set to Testnet
          </button>

          <button type="button" data-network="mainnet"
                  class="btn btn-outline btn-sm {% if active_network == 'mainnet' %}disabled{% endif %}">
            Set to Mainnet
          </button>
        </div>
      </div>
    </div>

    {% for wallet in wallets %}
      <div id="wallet-{{ wallet.id }}" class="space-y-4 p-4 rounded-lg bg-base-200">
        <h4 class="font-semibold text-lg flex items-center gap-2">
          {{ wallet.name }}
          {% comment %}
            The 'Active' badge will be dynamically added/removed by the frontend JS
          {% endcomment %}
        </h4>

        <div class="flex flex-wrap gap-2">
          <button id="connect-button-{{ wallet.id }}"
                  type="button"
                  class="btn btn-primary btn-sm">
            Connect
          </button>
          <button id="disconnect-button-{{ wallet.id }}"
                  type="button"
                  class="btn btn-error btn-sm">
            Disconnect
          </button>
          <button id="transaction-button-{{ wallet.id }}"
                  type="button"
                  class="btn btn-accent btn-sm">
            Send Transaction
          </button>
          <button id="auth-button-{{ wallet.id }}"
                  type="button"
                  class="btn btn-secondary btn-sm">
            Authenticate
          </button>
          <button id="set-active-button-{{ wallet.id }}"
                  type="button"
                  class="btn btn-outline btn-sm">
            Set Active
          </button>
        </div>

        {% if wallet.is_magic_link %}
          <div class="form-control w-full">
            <label for="magic-email-{{ wallet.id }}" class="label">
              <span class="label-text">Email</span>
            </label>
            <input id="magic-email-{{ wallet.id }}"
                   type="email"
                   placeholder="Enter email to connect..."
                   class="input input-bordered w-full"/>
          </div>
        {% endif %}

        <div class="form-control">
          <label class="label">
            <span class="label-text">Active Account</span>
          </label>
          <select id="active-account-select-{{ wallet.id }}" class="select select-bordered w-full">
            <option value="">No accounts</option>
          </select>
        </div>
      </div>
    {% endfor %}
  </div>
  <script type="module" src="{% static 'js/bundle.js' %}"></script>
</div>
