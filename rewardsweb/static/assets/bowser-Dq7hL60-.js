import{p as oe,d as Pr,g as gr,B as me,e as Lr,a as Ge}from"../js/bundle.js";import{d as Wr,c as de}from"./format-DCjLs-R4.js";var ue={},z={},Ze;function mr(){if(Ze)return z;Ze=1,Object.defineProperty(z,"__esModule",{value:!0}),z.getLocalStorage=z.getLocalStorageOrThrow=z.getCrypto=z.getCryptoOrThrow=z.getLocation=z.getLocationOrThrow=z.getNavigator=z.getNavigatorOrThrow=z.getDocument=z.getDocumentOrThrow=z.getFromWindowOrThrow=z.getFromWindow=void 0;function i(kt){let j;return typeof window<"u"&&typeof window[kt]<"u"&&(j=window[kt]),j}z.getFromWindow=i;function t(kt){const j=i(kt);if(!j)throw new Error(`${kt} is not defined in Window`);return j}z.getFromWindowOrThrow=t;function r(){return t("document")}z.getDocumentOrThrow=r;function f(){return i("document")}z.getDocument=f;function v(){return t("navigator")}z.getNavigatorOrThrow=v;function c(){return i("navigator")}z.getNavigator=c;function k(){return t("location")}z.getLocationOrThrow=k;function C(){return i("location")}z.getLocation=C;function E(){return t("crypto")}z.getCryptoOrThrow=E;function P(){return i("crypto")}z.getCrypto=P;function H(){return t("localStorage")}z.getLocalStorageOrThrow=H;function Rt(){return i("localStorage")}return z.getLocalStorage=Rt,z}var Qe;function Ur(){if(Qe)return ue;Qe=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.getWindowMetadata=void 0;const i=mr();function t(){let r,f;try{r=i.getDocumentOrThrow(),f=i.getLocationOrThrow()}catch{return null}function v(){const j=r.getElementsByTagName("link"),$=[];for(let It=0;It<j.length;It++){const b=j[It],S=b.getAttribute("rel");if(S&&S.toLowerCase().indexOf("icon")>-1){const O=b.getAttribute("href");if(O)if(O.toLowerCase().indexOf("https:")===-1&&O.toLowerCase().indexOf("http:")===-1&&O.indexOf("//")!==0){let R=f.protocol+"//"+f.host;if(O.indexOf("/")===0)R+=O;else{const W=f.pathname.split("/");W.pop();const K=W.join("/");R+=K+"/"+O}$.push(R)}else if(O.indexOf("//")===0){const R=f.protocol+O;$.push(R)}else $.push(O)}}return $}function c(...j){const $=r.getElementsByTagName("meta");for(let It=0;It<$.length;It++){const b=$[It],S=["itemprop","property","name"].map(O=>b.getAttribute(O)).filter(O=>O?j.includes(O):!1);if(S.length&&S){const O=b.getAttribute("content");if(O)return O}}return""}function k(){let j=c("name","og:site_name","og:title","twitter:title");return j||(j=r.title),j}function C(){return c("description","og:description","twitter:description","keywords")}const E=k(),P=C(),H=f.origin,Rt=v();return{description:P,url:H,icons:Rt,name:E}}return ue.getWindowMetadata=t,ue}var Dr=Ur(),He=mr(),jr=function(){for(var i=0,t=0,r=arguments.length;t<r;t++)i+=arguments[t].length;for(var f=Array(i),v=0,t=0;t<r;t++)for(var c=arguments[t],k=0,C=c.length;k<C;k++,v++)f[v]=c[k];return f},Hr=(function(){function i(t,r,f){this.name=t,this.version=r,this.os=f,this.type="browser"}return i})(),zr=(function(){function i(t){this.version=t,this.type="node",this.name="node",this.os=oe.platform}return i})(),Vr=(function(){function i(t,r,f,v){this.name=t,this.version=r,this.os=f,this.bot=v,this.type="bot-device"}return i})(),$r=(function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i})(),Kr=(function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i})(),Jr=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Gr=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Xe=3,Zr=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",Jr]],Ye=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Qr(i){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Kr:typeof navigator<"u"?Yr(navigator.userAgent):ei()}function Xr(i){return i!==""&&Zr.reduce(function(t,r){var f=r[0],v=r[1];if(t)return t;var c=v.exec(i);return!!c&&[f,c]},!1)}function Yr(i){var t=Xr(i);if(!t)return null;var r=t[0],f=t[1];if(r==="searchbot")return new $r;var v=f[1]&&f[1].split(/[._]/).slice(0,3);v?v.length<Xe&&(v=jr(v,ri(Xe-v.length))):v=[];var c=v.join("."),k=ti(i),C=Gr.exec(i);return C&&C[1]?new Vr(r,c,k,C[1]):new Hr(r,c,k)}function ti(i){for(var t=0,r=Ye.length;t<r;t++){var f=Ye[t],v=f[0],c=f[1],k=c.exec(i);if(k)return v}return null}function ei(){var i=typeof oe<"u"&&oe.version;return i?new zr(oe.version.slice(1)):null}function ri(i){for(var t=[],r=0;r<i;r++)t.push("0");return t}function ze(i){return Qr()}function Ve(){const i=ze();return i&&i.os?i.os:void 0}function ii(){const i=Ve();return i?i.toLowerCase().includes("android"):!1}function ni(){const i=Ve();return i?i.toLowerCase().includes("ios")||i.toLowerCase().includes("mac")&&navigator.maxTouchPoints>1:!1}function si(){return Ve()?ii()||ni():!1}function oi(){const i=ze();return i&&i.name?i.name.toLowerCase()==="node":!1}function ai(){return!oi()&&!!hi()}const hi=He.getNavigator,fi=He.getLocation,$e=He.getLocalStorage;function tr(){return Dr.getWindowMetadata()}function ci(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return JSON.parse(i)}catch{return i}}function ui(i){return typeof i=="string"?i:JSON.stringify(i)}const li=ci,di=ui;function pi(i,t){const r=di(t),f=$e();f&&f.setItem(i,r)}function vr(i){let t=null,r=null;const f=$e();return f&&(r=f.getItem(i)),t=r&&li(r),t}function wr(i){const t=$e();t&&t.removeItem(i)}const er="WALLETCONNECT_DEEPLINK_CHOICE",gi=["session_request","session_update","exchange_key","connect","disconnect","display_uri","modal_closed","transport_open","transport_close","transport_error"],yr=["eth_sendTransaction","eth_signTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v2","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","wallet_addEthereumChain","wallet_switchEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"];var ge={exports:{}},mi=ge.exports,rr;function vi(){return rr||(rr=1,(function(i){(function(t,r){function f(p,e){if(!p)throw new Error(e||"Assertion failed")}function v(p,e){p.super_=e;var s=function(){};s.prototype=e.prototype,p.prototype=new s,p.prototype.constructor=p}function c(p,e,s){if(c.isBN(p))return p;this.negative=0,this.words=null,this.length=0,this.red=null,p!==null&&((e==="le"||e==="be")&&(s=e,e=10),this._init(p||0,e||10,s||"be"))}typeof t=="object"?t.exports=c:r.BN=c,c.BN=c,c.wordSize=26;var k;try{k=Pr().Buffer}catch{}c.isBN=function(e){return e instanceof c?!0:e!==null&&typeof e=="object"&&e.constructor.wordSize===c.wordSize&&Array.isArray(e.words)},c.max=function(e,s){return e.cmp(s)>0?e:s},c.min=function(e,s){return e.cmp(s)<0?e:s},c.prototype._init=function(e,s,a){if(typeof e=="number")return this._initNumber(e,s,a);if(typeof e=="object")return this._initArray(e,s,a);s==="hex"&&(s=16),f(s===(s|0)&&s>=2&&s<=36),e=e.toString().replace(/\s+/g,"");var h=0;e[0]==="-"&&h++,s===16?this._parseHex(e,h):this._parseBase(e,s,h),e[0]==="-"&&(this.negative=1),this.strip(),a==="le"&&this._initArray(this.toArray(),s,a)},c.prototype._initNumber=function(e,s,a){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[e&67108863],this.length=1):e<4503599627370496?(this.words=[e&67108863,e/67108864&67108863],this.length=2):(f(e<9007199254740992),this.words=[e&67108863,e/67108864&67108863,1],this.length=3),a==="le"&&this._initArray(this.toArray(),s,a)},c.prototype._initArray=function(e,s,a){if(f(typeof e.length=="number"),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var h=0;h<this.length;h++)this.words[h]=0;var d,g,m=0;if(a==="be")for(h=e.length-1,d=0;h>=0;h-=3)g=e[h]|e[h-1]<<8|e[h-2]<<16,this.words[d]|=g<<m&67108863,this.words[d+1]=g>>>26-m&67108863,m+=24,m>=26&&(m-=26,d++);else if(a==="le")for(h=0,d=0;h<e.length;h+=3)g=e[h]|e[h+1]<<8|e[h+2]<<16,this.words[d]|=g<<m&67108863,this.words[d+1]=g>>>26-m&67108863,m+=24,m>=26&&(m-=26,d++);return this.strip()};function C(p,e,s){for(var a=0,h=Math.min(p.length,s),d=e;d<h;d++){var g=p.charCodeAt(d)-48;a<<=4,g>=49&&g<=54?a|=g-49+10:g>=17&&g<=22?a|=g-17+10:a|=g&15}return a}c.prototype._parseHex=function(e,s){this.length=Math.ceil((e.length-s)/6),this.words=new Array(this.length);for(var a=0;a<this.length;a++)this.words[a]=0;var h,d,g=0;for(a=e.length-6,h=0;a>=s;a-=6)d=C(e,a,a+6),this.words[h]|=d<<g&67108863,this.words[h+1]|=d>>>26-g&4194303,g+=24,g>=26&&(g-=26,h++);a+6!==s&&(d=C(e,s,a+6),this.words[h]|=d<<g&67108863,this.words[h+1]|=d>>>26-g&4194303),this.strip()};function E(p,e,s,a){for(var h=0,d=Math.min(p.length,s),g=e;g<d;g++){var m=p.charCodeAt(g)-48;h*=a,m>=49?h+=m-49+10:m>=17?h+=m-17+10:h+=m}return h}c.prototype._parseBase=function(e,s,a){this.words=[0],this.length=1;for(var h=0,d=1;d<=67108863;d*=s)h++;h--,d=d/s|0;for(var g=e.length-a,m=g%h,u=Math.min(g,g-m)+a,n=0,l=a;l<u;l+=h)n=E(e,l,l+h,s),this.imuln(d),this.words[0]+n<67108864?this.words[0]+=n:this._iaddn(n);if(m!==0){var F=1;for(n=E(e,l,e.length,s),l=0;l<m;l++)F*=s;this.imuln(F),this.words[0]+n<67108864?this.words[0]+=n:this._iaddn(n)}},c.prototype.copy=function(e){e.words=new Array(this.length);for(var s=0;s<this.length;s++)e.words[s]=this.words[s];e.length=this.length,e.negative=this.negative,e.red=this.red},c.prototype.clone=function(){var e=new c(null);return this.copy(e),e},c.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},c.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},c.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},c.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var P=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],H=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],Rt=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];c.prototype.toString=function(e,s){e=e||10,s=s|0||1;var a;if(e===16||e==="hex"){a="";for(var h=0,d=0,g=0;g<this.length;g++){var m=this.words[g],u=((m<<h|d)&16777215).toString(16);d=m>>>24-h&16777215,d!==0||g!==this.length-1?a=P[6-u.length]+u+a:a=u+a,h+=2,h>=26&&(h-=26,g--)}for(d!==0&&(a=d.toString(16)+a);a.length%s!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}if(e===(e|0)&&e>=2&&e<=36){var n=H[e],l=Rt[e];a="";var F=this.clone();for(F.negative=0;!F.isZero();){var A=F.modn(l).toString(e);F=F.idivn(l),F.isZero()?a=A+a:a=P[n-A.length]+A+a}for(this.isZero()&&(a="0"+a);a.length%s!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}f(!1,"Base should be between 2 and 36")},c.prototype.toNumber=function(){var e=this.words[0];return this.length===2?e+=this.words[1]*67108864:this.length===3&&this.words[2]===1?e+=4503599627370496+this.words[1]*67108864:this.length>2&&f(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-e:e},c.prototype.toJSON=function(){return this.toString(16)},c.prototype.toBuffer=function(e,s){return f(typeof k<"u"),this.toArrayLike(k,e,s)},c.prototype.toArray=function(e,s){return this.toArrayLike(Array,e,s)},c.prototype.toArrayLike=function(e,s,a){var h=this.byteLength(),d=a||Math.max(1,h);f(h<=d,"byte array longer than desired length"),f(d>0,"Requested array length <= 0"),this.strip();var g=s==="le",m=new e(d),u,n,l=this.clone();if(g){for(n=0;!l.isZero();n++)u=l.andln(255),l.iushrn(8),m[n]=u;for(;n<d;n++)m[n]=0}else{for(n=0;n<d-h;n++)m[n]=0;for(n=0;!l.isZero();n++)u=l.andln(255),l.iushrn(8),m[d-n-1]=u}return m},Math.clz32?c.prototype._countBits=function(e){return 32-Math.clz32(e)}:c.prototype._countBits=function(e){var s=e,a=0;return s>=4096&&(a+=13,s>>>=13),s>=64&&(a+=7,s>>>=7),s>=8&&(a+=4,s>>>=4),s>=2&&(a+=2,s>>>=2),a+s},c.prototype._zeroBits=function(e){if(e===0)return 26;var s=e,a=0;return(s&8191)===0&&(a+=13,s>>>=13),(s&127)===0&&(a+=7,s>>>=7),(s&15)===0&&(a+=4,s>>>=4),(s&3)===0&&(a+=2,s>>>=2),(s&1)===0&&a++,a},c.prototype.bitLength=function(){var e=this.words[this.length-1],s=this._countBits(e);return(this.length-1)*26+s};function kt(p){for(var e=new Array(p.bitLength()),s=0;s<e.length;s++){var a=s/26|0,h=s%26;e[s]=(p.words[a]&1<<h)>>>h}return e}c.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,s=0;s<this.length;s++){var a=this._zeroBits(this.words[s]);if(e+=a,a!==26)break}return e},c.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},c.prototype.toTwos=function(e){return this.negative!==0?this.abs().inotn(e).iaddn(1):this.clone()},c.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},c.prototype.isNeg=function(){return this.negative!==0},c.prototype.neg=function(){return this.clone().ineg()},c.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},c.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var s=0;s<e.length;s++)this.words[s]=this.words[s]|e.words[s];return this.strip()},c.prototype.ior=function(e){return f((this.negative|e.negative)===0),this.iuor(e)},c.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},c.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},c.prototype.iuand=function(e){var s;this.length>e.length?s=e:s=this;for(var a=0;a<s.length;a++)this.words[a]=this.words[a]&e.words[a];return this.length=s.length,this.strip()},c.prototype.iand=function(e){return f((this.negative|e.negative)===0),this.iuand(e)},c.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},c.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},c.prototype.iuxor=function(e){var s,a;this.length>e.length?(s=this,a=e):(s=e,a=this);for(var h=0;h<a.length;h++)this.words[h]=s.words[h]^a.words[h];if(this!==s)for(;h<s.length;h++)this.words[h]=s.words[h];return this.length=s.length,this.strip()},c.prototype.ixor=function(e){return f((this.negative|e.negative)===0),this.iuxor(e)},c.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},c.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},c.prototype.inotn=function(e){f(typeof e=="number"&&e>=0);var s=Math.ceil(e/26)|0,a=e%26;this._expand(s),a>0&&s--;for(var h=0;h<s;h++)this.words[h]=~this.words[h]&67108863;return a>0&&(this.words[h]=~this.words[h]&67108863>>26-a),this.strip()},c.prototype.notn=function(e){return this.clone().inotn(e)},c.prototype.setn=function(e,s){f(typeof e=="number"&&e>=0);var a=e/26|0,h=e%26;return this._expand(a+1),s?this.words[a]=this.words[a]|1<<h:this.words[a]=this.words[a]&~(1<<h),this.strip()},c.prototype.iadd=function(e){var s;if(this.negative!==0&&e.negative===0)return this.negative=0,s=this.isub(e),this.negative^=1,this._normSign();if(this.negative===0&&e.negative!==0)return e.negative=0,s=this.isub(e),e.negative=1,s._normSign();var a,h;this.length>e.length?(a=this,h=e):(a=e,h=this);for(var d=0,g=0;g<h.length;g++)s=(a.words[g]|0)+(h.words[g]|0)+d,this.words[g]=s&67108863,d=s>>>26;for(;d!==0&&g<a.length;g++)s=(a.words[g]|0)+d,this.words[g]=s&67108863,d=s>>>26;if(this.length=a.length,d!==0)this.words[this.length]=d,this.length++;else if(a!==this)for(;g<a.length;g++)this.words[g]=a.words[g];return this},c.prototype.add=function(e){var s;return e.negative!==0&&this.negative===0?(e.negative=0,s=this.sub(e),e.negative^=1,s):e.negative===0&&this.negative!==0?(this.negative=0,s=e.sub(this),this.negative=1,s):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},c.prototype.isub=function(e){if(e.negative!==0){e.negative=0;var s=this.iadd(e);return e.negative=1,s._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var a=this.cmp(e);if(a===0)return this.negative=0,this.length=1,this.words[0]=0,this;var h,d;a>0?(h=this,d=e):(h=e,d=this);for(var g=0,m=0;m<d.length;m++)s=(h.words[m]|0)-(d.words[m]|0)+g,g=s>>26,this.words[m]=s&67108863;for(;g!==0&&m<h.length;m++)s=(h.words[m]|0)+g,g=s>>26,this.words[m]=s&67108863;if(g===0&&m<h.length&&h!==this)for(;m<h.length;m++)this.words[m]=h.words[m];return this.length=Math.max(this.length,m),h!==this&&(this.negative=1),this.strip()},c.prototype.sub=function(e){return this.clone().isub(e)};function j(p,e,s){s.negative=e.negative^p.negative;var a=p.length+e.length|0;s.length=a,a=a-1|0;var h=p.words[0]|0,d=e.words[0]|0,g=h*d,m=g&67108863,u=g/67108864|0;s.words[0]=m;for(var n=1;n<a;n++){for(var l=u>>>26,F=u&67108863,A=Math.min(n,e.length-1),N=Math.max(0,n-p.length+1);N<=A;N++){var L=n-N|0;h=p.words[L]|0,d=e.words[N]|0,g=h*d+F,l+=g/67108864|0,F=g&67108863}s.words[n]=F|0,u=l|0}return u!==0?s.words[n]=u|0:s.length--,s.strip()}var $=function(e,s,a){var h=e.words,d=s.words,g=a.words,m=0,u,n,l,F=h[0]|0,A=F&8191,N=F>>>13,L=h[1]|0,o=L&8191,w=L>>>13,_=h[2]|0,y=_&8191,x=_>>>13,q=h[3]|0,B=q&8191,I=q>>>13,Ot=h[4]|0,T=Ot&8191,U=Ot>>>13,zt=h[5]|0,G=zt&8191,Z=zt>>>13,Vt=h[6]|0,Q=Vt&8191,X=Vt>>>13,$t=h[7]|0,Y=$t&8191,tt=$t>>>13,Kt=h[8]|0,et=Kt&8191,rt=Kt>>>13,Jt=h[9]|0,it=Jt&8191,nt=Jt>>>13,Gt=d[0]|0,st=Gt&8191,ot=Gt>>>13,Zt=d[1]|0,at=Zt&8191,ht=Zt>>>13,Qt=d[2]|0,ft=Qt&8191,ct=Qt>>>13,Xt=d[3]|0,ut=Xt&8191,lt=Xt>>>13,Yt=d[4]|0,dt=Yt&8191,pt=Yt>>>13,te=d[5]|0,gt=te&8191,mt=te>>>13,ee=d[6]|0,vt=ee&8191,wt=ee>>>13,re=d[7]|0,yt=re&8191,Mt=re>>>13,ie=d[8]|0,bt=ie&8191,_t=ie>>>13,ne=d[9]|0,St=ne&8191,xt=ne>>>13;a.negative=e.negative^s.negative,a.length=19,u=Math.imul(A,st),n=Math.imul(A,ot),n=n+Math.imul(N,st)|0,l=Math.imul(N,ot);var Ft=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,u=Math.imul(o,st),n=Math.imul(o,ot),n=n+Math.imul(w,st)|0,l=Math.imul(w,ot),u=u+Math.imul(A,at)|0,n=n+Math.imul(A,ht)|0,n=n+Math.imul(N,at)|0,l=l+Math.imul(N,ht)|0;var Ct=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,u=Math.imul(y,st),n=Math.imul(y,ot),n=n+Math.imul(x,st)|0,l=Math.imul(x,ot),u=u+Math.imul(o,at)|0,n=n+Math.imul(o,ht)|0,n=n+Math.imul(w,at)|0,l=l+Math.imul(w,ht)|0,u=u+Math.imul(A,ft)|0,n=n+Math.imul(A,ct)|0,n=n+Math.imul(N,ft)|0,l=l+Math.imul(N,ct)|0;var Nt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,u=Math.imul(B,st),n=Math.imul(B,ot),n=n+Math.imul(I,st)|0,l=Math.imul(I,ot),u=u+Math.imul(y,at)|0,n=n+Math.imul(y,ht)|0,n=n+Math.imul(x,at)|0,l=l+Math.imul(x,ht)|0,u=u+Math.imul(o,ft)|0,n=n+Math.imul(o,ct)|0,n=n+Math.imul(w,ft)|0,l=l+Math.imul(w,ct)|0,u=u+Math.imul(A,ut)|0,n=n+Math.imul(A,lt)|0,n=n+Math.imul(N,ut)|0,l=l+Math.imul(N,lt)|0;var qt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(qt>>>26)|0,qt&=67108863,u=Math.imul(T,st),n=Math.imul(T,ot),n=n+Math.imul(U,st)|0,l=Math.imul(U,ot),u=u+Math.imul(B,at)|0,n=n+Math.imul(B,ht)|0,n=n+Math.imul(I,at)|0,l=l+Math.imul(I,ht)|0,u=u+Math.imul(y,ft)|0,n=n+Math.imul(y,ct)|0,n=n+Math.imul(x,ft)|0,l=l+Math.imul(x,ct)|0,u=u+Math.imul(o,ut)|0,n=n+Math.imul(o,lt)|0,n=n+Math.imul(w,ut)|0,l=l+Math.imul(w,lt)|0,u=u+Math.imul(A,dt)|0,n=n+Math.imul(A,pt)|0,n=n+Math.imul(N,dt)|0,l=l+Math.imul(N,pt)|0;var Pt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,u=Math.imul(G,st),n=Math.imul(G,ot),n=n+Math.imul(Z,st)|0,l=Math.imul(Z,ot),u=u+Math.imul(T,at)|0,n=n+Math.imul(T,ht)|0,n=n+Math.imul(U,at)|0,l=l+Math.imul(U,ht)|0,u=u+Math.imul(B,ft)|0,n=n+Math.imul(B,ct)|0,n=n+Math.imul(I,ft)|0,l=l+Math.imul(I,ct)|0,u=u+Math.imul(y,ut)|0,n=n+Math.imul(y,lt)|0,n=n+Math.imul(x,ut)|0,l=l+Math.imul(x,lt)|0,u=u+Math.imul(o,dt)|0,n=n+Math.imul(o,pt)|0,n=n+Math.imul(w,dt)|0,l=l+Math.imul(w,pt)|0,u=u+Math.imul(A,gt)|0,n=n+Math.imul(A,mt)|0,n=n+Math.imul(N,gt)|0,l=l+Math.imul(N,mt)|0;var Lt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,u=Math.imul(Q,st),n=Math.imul(Q,ot),n=n+Math.imul(X,st)|0,l=Math.imul(X,ot),u=u+Math.imul(G,at)|0,n=n+Math.imul(G,ht)|0,n=n+Math.imul(Z,at)|0,l=l+Math.imul(Z,ht)|0,u=u+Math.imul(T,ft)|0,n=n+Math.imul(T,ct)|0,n=n+Math.imul(U,ft)|0,l=l+Math.imul(U,ct)|0,u=u+Math.imul(B,ut)|0,n=n+Math.imul(B,lt)|0,n=n+Math.imul(I,ut)|0,l=l+Math.imul(I,lt)|0,u=u+Math.imul(y,dt)|0,n=n+Math.imul(y,pt)|0,n=n+Math.imul(x,dt)|0,l=l+Math.imul(x,pt)|0,u=u+Math.imul(o,gt)|0,n=n+Math.imul(o,mt)|0,n=n+Math.imul(w,gt)|0,l=l+Math.imul(w,mt)|0,u=u+Math.imul(A,vt)|0,n=n+Math.imul(A,wt)|0,n=n+Math.imul(N,vt)|0,l=l+Math.imul(N,wt)|0;var Wt=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,u=Math.imul(Y,st),n=Math.imul(Y,ot),n=n+Math.imul(tt,st)|0,l=Math.imul(tt,ot),u=u+Math.imul(Q,at)|0,n=n+Math.imul(Q,ht)|0,n=n+Math.imul(X,at)|0,l=l+Math.imul(X,ht)|0,u=u+Math.imul(G,ft)|0,n=n+Math.imul(G,ct)|0,n=n+Math.imul(Z,ft)|0,l=l+Math.imul(Z,ct)|0,u=u+Math.imul(T,ut)|0,n=n+Math.imul(T,lt)|0,n=n+Math.imul(U,ut)|0,l=l+Math.imul(U,lt)|0,u=u+Math.imul(B,dt)|0,n=n+Math.imul(B,pt)|0,n=n+Math.imul(I,dt)|0,l=l+Math.imul(I,pt)|0,u=u+Math.imul(y,gt)|0,n=n+Math.imul(y,mt)|0,n=n+Math.imul(x,gt)|0,l=l+Math.imul(x,mt)|0,u=u+Math.imul(o,vt)|0,n=n+Math.imul(o,wt)|0,n=n+Math.imul(w,vt)|0,l=l+Math.imul(w,wt)|0,u=u+Math.imul(A,yt)|0,n=n+Math.imul(A,Mt)|0,n=n+Math.imul(N,yt)|0,l=l+Math.imul(N,Mt)|0;var Ut=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,u=Math.imul(et,st),n=Math.imul(et,ot),n=n+Math.imul(rt,st)|0,l=Math.imul(rt,ot),u=u+Math.imul(Y,at)|0,n=n+Math.imul(Y,ht)|0,n=n+Math.imul(tt,at)|0,l=l+Math.imul(tt,ht)|0,u=u+Math.imul(Q,ft)|0,n=n+Math.imul(Q,ct)|0,n=n+Math.imul(X,ft)|0,l=l+Math.imul(X,ct)|0,u=u+Math.imul(G,ut)|0,n=n+Math.imul(G,lt)|0,n=n+Math.imul(Z,ut)|0,l=l+Math.imul(Z,lt)|0,u=u+Math.imul(T,dt)|0,n=n+Math.imul(T,pt)|0,n=n+Math.imul(U,dt)|0,l=l+Math.imul(U,pt)|0,u=u+Math.imul(B,gt)|0,n=n+Math.imul(B,mt)|0,n=n+Math.imul(I,gt)|0,l=l+Math.imul(I,mt)|0,u=u+Math.imul(y,vt)|0,n=n+Math.imul(y,wt)|0,n=n+Math.imul(x,vt)|0,l=l+Math.imul(x,wt)|0,u=u+Math.imul(o,yt)|0,n=n+Math.imul(o,Mt)|0,n=n+Math.imul(w,yt)|0,l=l+Math.imul(w,Mt)|0,u=u+Math.imul(A,bt)|0,n=n+Math.imul(A,_t)|0,n=n+Math.imul(N,bt)|0,l=l+Math.imul(N,_t)|0;var Me=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Me>>>26)|0,Me&=67108863,u=Math.imul(it,st),n=Math.imul(it,ot),n=n+Math.imul(nt,st)|0,l=Math.imul(nt,ot),u=u+Math.imul(et,at)|0,n=n+Math.imul(et,ht)|0,n=n+Math.imul(rt,at)|0,l=l+Math.imul(rt,ht)|0,u=u+Math.imul(Y,ft)|0,n=n+Math.imul(Y,ct)|0,n=n+Math.imul(tt,ft)|0,l=l+Math.imul(tt,ct)|0,u=u+Math.imul(Q,ut)|0,n=n+Math.imul(Q,lt)|0,n=n+Math.imul(X,ut)|0,l=l+Math.imul(X,lt)|0,u=u+Math.imul(G,dt)|0,n=n+Math.imul(G,pt)|0,n=n+Math.imul(Z,dt)|0,l=l+Math.imul(Z,pt)|0,u=u+Math.imul(T,gt)|0,n=n+Math.imul(T,mt)|0,n=n+Math.imul(U,gt)|0,l=l+Math.imul(U,mt)|0,u=u+Math.imul(B,vt)|0,n=n+Math.imul(B,wt)|0,n=n+Math.imul(I,vt)|0,l=l+Math.imul(I,wt)|0,u=u+Math.imul(y,yt)|0,n=n+Math.imul(y,Mt)|0,n=n+Math.imul(x,yt)|0,l=l+Math.imul(x,Mt)|0,u=u+Math.imul(o,bt)|0,n=n+Math.imul(o,_t)|0,n=n+Math.imul(w,bt)|0,l=l+Math.imul(w,_t)|0,u=u+Math.imul(A,St)|0,n=n+Math.imul(A,xt)|0,n=n+Math.imul(N,St)|0,l=l+Math.imul(N,xt)|0;var be=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(be>>>26)|0,be&=67108863,u=Math.imul(it,at),n=Math.imul(it,ht),n=n+Math.imul(nt,at)|0,l=Math.imul(nt,ht),u=u+Math.imul(et,ft)|0,n=n+Math.imul(et,ct)|0,n=n+Math.imul(rt,ft)|0,l=l+Math.imul(rt,ct)|0,u=u+Math.imul(Y,ut)|0,n=n+Math.imul(Y,lt)|0,n=n+Math.imul(tt,ut)|0,l=l+Math.imul(tt,lt)|0,u=u+Math.imul(Q,dt)|0,n=n+Math.imul(Q,pt)|0,n=n+Math.imul(X,dt)|0,l=l+Math.imul(X,pt)|0,u=u+Math.imul(G,gt)|0,n=n+Math.imul(G,mt)|0,n=n+Math.imul(Z,gt)|0,l=l+Math.imul(Z,mt)|0,u=u+Math.imul(T,vt)|0,n=n+Math.imul(T,wt)|0,n=n+Math.imul(U,vt)|0,l=l+Math.imul(U,wt)|0,u=u+Math.imul(B,yt)|0,n=n+Math.imul(B,Mt)|0,n=n+Math.imul(I,yt)|0,l=l+Math.imul(I,Mt)|0,u=u+Math.imul(y,bt)|0,n=n+Math.imul(y,_t)|0,n=n+Math.imul(x,bt)|0,l=l+Math.imul(x,_t)|0,u=u+Math.imul(o,St)|0,n=n+Math.imul(o,xt)|0,n=n+Math.imul(w,St)|0,l=l+Math.imul(w,xt)|0;var _e=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(_e>>>26)|0,_e&=67108863,u=Math.imul(it,ft),n=Math.imul(it,ct),n=n+Math.imul(nt,ft)|0,l=Math.imul(nt,ct),u=u+Math.imul(et,ut)|0,n=n+Math.imul(et,lt)|0,n=n+Math.imul(rt,ut)|0,l=l+Math.imul(rt,lt)|0,u=u+Math.imul(Y,dt)|0,n=n+Math.imul(Y,pt)|0,n=n+Math.imul(tt,dt)|0,l=l+Math.imul(tt,pt)|0,u=u+Math.imul(Q,gt)|0,n=n+Math.imul(Q,mt)|0,n=n+Math.imul(X,gt)|0,l=l+Math.imul(X,mt)|0,u=u+Math.imul(G,vt)|0,n=n+Math.imul(G,wt)|0,n=n+Math.imul(Z,vt)|0,l=l+Math.imul(Z,wt)|0,u=u+Math.imul(T,yt)|0,n=n+Math.imul(T,Mt)|0,n=n+Math.imul(U,yt)|0,l=l+Math.imul(U,Mt)|0,u=u+Math.imul(B,bt)|0,n=n+Math.imul(B,_t)|0,n=n+Math.imul(I,bt)|0,l=l+Math.imul(I,_t)|0,u=u+Math.imul(y,St)|0,n=n+Math.imul(y,xt)|0,n=n+Math.imul(x,St)|0,l=l+Math.imul(x,xt)|0;var Se=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Se>>>26)|0,Se&=67108863,u=Math.imul(it,ut),n=Math.imul(it,lt),n=n+Math.imul(nt,ut)|0,l=Math.imul(nt,lt),u=u+Math.imul(et,dt)|0,n=n+Math.imul(et,pt)|0,n=n+Math.imul(rt,dt)|0,l=l+Math.imul(rt,pt)|0,u=u+Math.imul(Y,gt)|0,n=n+Math.imul(Y,mt)|0,n=n+Math.imul(tt,gt)|0,l=l+Math.imul(tt,mt)|0,u=u+Math.imul(Q,vt)|0,n=n+Math.imul(Q,wt)|0,n=n+Math.imul(X,vt)|0,l=l+Math.imul(X,wt)|0,u=u+Math.imul(G,yt)|0,n=n+Math.imul(G,Mt)|0,n=n+Math.imul(Z,yt)|0,l=l+Math.imul(Z,Mt)|0,u=u+Math.imul(T,bt)|0,n=n+Math.imul(T,_t)|0,n=n+Math.imul(U,bt)|0,l=l+Math.imul(U,_t)|0,u=u+Math.imul(B,St)|0,n=n+Math.imul(B,xt)|0,n=n+Math.imul(I,St)|0,l=l+Math.imul(I,xt)|0;var xe=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(xe>>>26)|0,xe&=67108863,u=Math.imul(it,dt),n=Math.imul(it,pt),n=n+Math.imul(nt,dt)|0,l=Math.imul(nt,pt),u=u+Math.imul(et,gt)|0,n=n+Math.imul(et,mt)|0,n=n+Math.imul(rt,gt)|0,l=l+Math.imul(rt,mt)|0,u=u+Math.imul(Y,vt)|0,n=n+Math.imul(Y,wt)|0,n=n+Math.imul(tt,vt)|0,l=l+Math.imul(tt,wt)|0,u=u+Math.imul(Q,yt)|0,n=n+Math.imul(Q,Mt)|0,n=n+Math.imul(X,yt)|0,l=l+Math.imul(X,Mt)|0,u=u+Math.imul(G,bt)|0,n=n+Math.imul(G,_t)|0,n=n+Math.imul(Z,bt)|0,l=l+Math.imul(Z,_t)|0,u=u+Math.imul(T,St)|0,n=n+Math.imul(T,xt)|0,n=n+Math.imul(U,St)|0,l=l+Math.imul(U,xt)|0;var ke=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(ke>>>26)|0,ke&=67108863,u=Math.imul(it,gt),n=Math.imul(it,mt),n=n+Math.imul(nt,gt)|0,l=Math.imul(nt,mt),u=u+Math.imul(et,vt)|0,n=n+Math.imul(et,wt)|0,n=n+Math.imul(rt,vt)|0,l=l+Math.imul(rt,wt)|0,u=u+Math.imul(Y,yt)|0,n=n+Math.imul(Y,Mt)|0,n=n+Math.imul(tt,yt)|0,l=l+Math.imul(tt,Mt)|0,u=u+Math.imul(Q,bt)|0,n=n+Math.imul(Q,_t)|0,n=n+Math.imul(X,bt)|0,l=l+Math.imul(X,_t)|0,u=u+Math.imul(G,St)|0,n=n+Math.imul(G,xt)|0,n=n+Math.imul(Z,St)|0,l=l+Math.imul(Z,xt)|0;var Re=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,u=Math.imul(it,vt),n=Math.imul(it,wt),n=n+Math.imul(nt,vt)|0,l=Math.imul(nt,wt),u=u+Math.imul(et,yt)|0,n=n+Math.imul(et,Mt)|0,n=n+Math.imul(rt,yt)|0,l=l+Math.imul(rt,Mt)|0,u=u+Math.imul(Y,bt)|0,n=n+Math.imul(Y,_t)|0,n=n+Math.imul(tt,bt)|0,l=l+Math.imul(tt,_t)|0,u=u+Math.imul(Q,St)|0,n=n+Math.imul(Q,xt)|0,n=n+Math.imul(X,St)|0,l=l+Math.imul(X,xt)|0;var Oe=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,u=Math.imul(it,yt),n=Math.imul(it,Mt),n=n+Math.imul(nt,yt)|0,l=Math.imul(nt,Mt),u=u+Math.imul(et,bt)|0,n=n+Math.imul(et,_t)|0,n=n+Math.imul(rt,bt)|0,l=l+Math.imul(rt,_t)|0,u=u+Math.imul(Y,St)|0,n=n+Math.imul(Y,xt)|0,n=n+Math.imul(tt,St)|0,l=l+Math.imul(tt,xt)|0;var Ae=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,u=Math.imul(it,bt),n=Math.imul(it,_t),n=n+Math.imul(nt,bt)|0,l=Math.imul(nt,_t),u=u+Math.imul(et,St)|0,n=n+Math.imul(et,xt)|0,n=n+Math.imul(rt,St)|0,l=l+Math.imul(rt,xt)|0;var Ee=(m+u|0)+((n&8191)<<13)|0;m=(l+(n>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,u=Math.imul(it,St),n=Math.imul(it,xt),n=n+Math.imul(nt,St)|0,l=Math.imul(nt,xt);var Ie=(m+u|0)+((n&8191)<<13)|0;return m=(l+(n>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,g[0]=Ft,g[1]=Ct,g[2]=Nt,g[3]=qt,g[4]=Pt,g[5]=Lt,g[6]=Wt,g[7]=Ut,g[8]=Me,g[9]=be,g[10]=_e,g[11]=Se,g[12]=xe,g[13]=ke,g[14]=Re,g[15]=Oe,g[16]=Ae,g[17]=Ee,g[18]=Ie,m!==0&&(g[19]=m,a.length++),a};Math.imul||($=j);function It(p,e,s){s.negative=e.negative^p.negative,s.length=p.length+e.length;for(var a=0,h=0,d=0;d<s.length-1;d++){var g=h;h=0;for(var m=a&67108863,u=Math.min(d,e.length-1),n=Math.max(0,d-p.length+1);n<=u;n++){var l=d-n,F=p.words[l]|0,A=e.words[n]|0,N=F*A,L=N&67108863;g=g+(N/67108864|0)|0,L=L+m|0,m=L&67108863,g=g+(L>>>26)|0,h+=g>>>26,g&=67108863}s.words[d]=m,a=g,g=h}return a!==0?s.words[d]=a:s.length--,s.strip()}function b(p,e,s){var a=new S;return a.mulp(p,e,s)}c.prototype.mulTo=function(e,s){var a,h=this.length+e.length;return this.length===10&&e.length===10?a=$(this,e,s):h<63?a=j(this,e,s):h<1024?a=It(this,e,s):a=b(this,e,s),a};function S(p,e){this.x=p,this.y=e}S.prototype.makeRBT=function(e){for(var s=new Array(e),a=c.prototype._countBits(e)-1,h=0;h<e;h++)s[h]=this.revBin(h,a,e);return s},S.prototype.revBin=function(e,s,a){if(e===0||e===a-1)return e;for(var h=0,d=0;d<s;d++)h|=(e&1)<<s-d-1,e>>=1;return h},S.prototype.permute=function(e,s,a,h,d,g){for(var m=0;m<g;m++)h[m]=s[e[m]],d[m]=a[e[m]]},S.prototype.transform=function(e,s,a,h,d,g){this.permute(g,e,s,a,h,d);for(var m=1;m<d;m<<=1)for(var u=m<<1,n=Math.cos(2*Math.PI/u),l=Math.sin(2*Math.PI/u),F=0;F<d;F+=u)for(var A=n,N=l,L=0;L<m;L++){var o=a[F+L],w=h[F+L],_=a[F+L+m],y=h[F+L+m],x=A*_-N*y;y=A*y+N*_,_=x,a[F+L]=o+_,h[F+L]=w+y,a[F+L+m]=o-_,h[F+L+m]=w-y,L!==u&&(x=n*A-l*N,N=n*N+l*A,A=x)}},S.prototype.guessLen13b=function(e,s){var a=Math.max(s,e)|1,h=a&1,d=0;for(a=a/2|0;a;a=a>>>1)d++;return 1<<d+1+h},S.prototype.conjugate=function(e,s,a){if(!(a<=1))for(var h=0;h<a/2;h++){var d=e[h];e[h]=e[a-h-1],e[a-h-1]=d,d=s[h],s[h]=-s[a-h-1],s[a-h-1]=-d}},S.prototype.normalize13b=function(e,s){for(var a=0,h=0;h<s/2;h++){var d=Math.round(e[2*h+1]/s)*8192+Math.round(e[2*h]/s)+a;e[h]=d&67108863,d<67108864?a=0:a=d/67108864|0}return e},S.prototype.convert13b=function(e,s,a,h){for(var d=0,g=0;g<s;g++)d=d+(e[g]|0),a[2*g]=d&8191,d=d>>>13,a[2*g+1]=d&8191,d=d>>>13;for(g=2*s;g<h;++g)a[g]=0;f(d===0),f((d&-8192)===0)},S.prototype.stub=function(e){for(var s=new Array(e),a=0;a<e;a++)s[a]=0;return s},S.prototype.mulp=function(e,s,a){var h=2*this.guessLen13b(e.length,s.length),d=this.makeRBT(h),g=this.stub(h),m=new Array(h),u=new Array(h),n=new Array(h),l=new Array(h),F=new Array(h),A=new Array(h),N=a.words;N.length=h,this.convert13b(e.words,e.length,m,h),this.convert13b(s.words,s.length,l,h),this.transform(m,g,u,n,h,d),this.transform(l,g,F,A,h,d);for(var L=0;L<h;L++){var o=u[L]*F[L]-n[L]*A[L];n[L]=u[L]*A[L]+n[L]*F[L],u[L]=o}return this.conjugate(u,n,h),this.transform(u,n,N,g,h,d),this.conjugate(N,g,h),this.normalize13b(N,h),a.negative=e.negative^s.negative,a.length=e.length+s.length,a.strip()},c.prototype.mul=function(e){var s=new c(null);return s.words=new Array(this.length+e.length),this.mulTo(e,s)},c.prototype.mulf=function(e){var s=new c(null);return s.words=new Array(this.length+e.length),b(this,e,s)},c.prototype.imul=function(e){return this.clone().mulTo(e,this)},c.prototype.imuln=function(e){f(typeof e=="number"),f(e<67108864);for(var s=0,a=0;a<this.length;a++){var h=(this.words[a]|0)*e,d=(h&67108863)+(s&67108863);s>>=26,s+=h/67108864|0,s+=d>>>26,this.words[a]=d&67108863}return s!==0&&(this.words[a]=s,this.length++),this},c.prototype.muln=function(e){return this.clone().imuln(e)},c.prototype.sqr=function(){return this.mul(this)},c.prototype.isqr=function(){return this.imul(this.clone())},c.prototype.pow=function(e){var s=kt(e);if(s.length===0)return new c(1);for(var a=this,h=0;h<s.length&&s[h]===0;h++,a=a.sqr());if(++h<s.length)for(var d=a.sqr();h<s.length;h++,d=d.sqr())s[h]!==0&&(a=a.mul(d));return a},c.prototype.iushln=function(e){f(typeof e=="number"&&e>=0);var s=e%26,a=(e-s)/26,h=67108863>>>26-s<<26-s,d;if(s!==0){var g=0;for(d=0;d<this.length;d++){var m=this.words[d]&h,u=(this.words[d]|0)-m<<s;this.words[d]=u|g,g=m>>>26-s}g&&(this.words[d]=g,this.length++)}if(a!==0){for(d=this.length-1;d>=0;d--)this.words[d+a]=this.words[d];for(d=0;d<a;d++)this.words[d]=0;this.length+=a}return this.strip()},c.prototype.ishln=function(e){return f(this.negative===0),this.iushln(e)},c.prototype.iushrn=function(e,s,a){f(typeof e=="number"&&e>=0);var h;s?h=(s-s%26)/26:h=0;var d=e%26,g=Math.min((e-d)/26,this.length),m=67108863^67108863>>>d<<d,u=a;if(h-=g,h=Math.max(0,h),u){for(var n=0;n<g;n++)u.words[n]=this.words[n];u.length=g}if(g!==0)if(this.length>g)for(this.length-=g,n=0;n<this.length;n++)this.words[n]=this.words[n+g];else this.words[0]=0,this.length=1;var l=0;for(n=this.length-1;n>=0&&(l!==0||n>=h);n--){var F=this.words[n]|0;this.words[n]=l<<26-d|F>>>d,l=F&m}return u&&l!==0&&(u.words[u.length++]=l),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},c.prototype.ishrn=function(e,s,a){return f(this.negative===0),this.iushrn(e,s,a)},c.prototype.shln=function(e){return this.clone().ishln(e)},c.prototype.ushln=function(e){return this.clone().iushln(e)},c.prototype.shrn=function(e){return this.clone().ishrn(e)},c.prototype.ushrn=function(e){return this.clone().iushrn(e)},c.prototype.testn=function(e){f(typeof e=="number"&&e>=0);var s=e%26,a=(e-s)/26,h=1<<s;if(this.length<=a)return!1;var d=this.words[a];return!!(d&h)},c.prototype.imaskn=function(e){f(typeof e=="number"&&e>=0);var s=e%26,a=(e-s)/26;if(f(this.negative===0,"imaskn works only with positive numbers"),this.length<=a)return this;if(s!==0&&a++,this.length=Math.min(a,this.length),s!==0){var h=67108863^67108863>>>s<<s;this.words[this.length-1]&=h}return this.strip()},c.prototype.maskn=function(e){return this.clone().imaskn(e)},c.prototype.iaddn=function(e){return f(typeof e=="number"),f(e<67108864),e<0?this.isubn(-e):this.negative!==0?this.length===1&&(this.words[0]|0)<e?(this.words[0]=e-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},c.prototype._iaddn=function(e){this.words[0]+=e;for(var s=0;s<this.length&&this.words[s]>=67108864;s++)this.words[s]-=67108864,s===this.length-1?this.words[s+1]=1:this.words[s+1]++;return this.length=Math.max(this.length,s+1),this},c.prototype.isubn=function(e){if(f(typeof e=="number"),f(e<67108864),e<0)return this.iaddn(-e);if(this.negative!==0)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var s=0;s<this.length&&this.words[s]<0;s++)this.words[s]+=67108864,this.words[s+1]-=1;return this.strip()},c.prototype.addn=function(e){return this.clone().iaddn(e)},c.prototype.subn=function(e){return this.clone().isubn(e)},c.prototype.iabs=function(){return this.negative=0,this},c.prototype.abs=function(){return this.clone().iabs()},c.prototype._ishlnsubmul=function(e,s,a){var h=e.length+a,d;this._expand(h);var g,m=0;for(d=0;d<e.length;d++){g=(this.words[d+a]|0)+m;var u=(e.words[d]|0)*s;g-=u&67108863,m=(g>>26)-(u/67108864|0),this.words[d+a]=g&67108863}for(;d<this.length-a;d++)g=(this.words[d+a]|0)+m,m=g>>26,this.words[d+a]=g&67108863;if(m===0)return this.strip();for(f(m===-1),m=0,d=0;d<this.length;d++)g=-(this.words[d]|0)+m,m=g>>26,this.words[d]=g&67108863;return this.negative=1,this.strip()},c.prototype._wordDiv=function(e,s){var a=this.length-e.length,h=this.clone(),d=e,g=d.words[d.length-1]|0,m=this._countBits(g);a=26-m,a!==0&&(d=d.ushln(a),h.iushln(a),g=d.words[d.length-1]|0);var u=h.length-d.length,n;if(s!=="mod"){n=new c(null),n.length=u+1,n.words=new Array(n.length);for(var l=0;l<n.length;l++)n.words[l]=0}var F=h.clone()._ishlnsubmul(d,1,u);F.negative===0&&(h=F,n&&(n.words[u]=1));for(var A=u-1;A>=0;A--){var N=(h.words[d.length+A]|0)*67108864+(h.words[d.length+A-1]|0);for(N=Math.min(N/g|0,67108863),h._ishlnsubmul(d,N,A);h.negative!==0;)N--,h.negative=0,h._ishlnsubmul(d,1,A),h.isZero()||(h.negative^=1);n&&(n.words[A]=N)}return n&&n.strip(),h.strip(),s!=="div"&&a!==0&&h.iushrn(a),{div:n||null,mod:h}},c.prototype.divmod=function(e,s,a){if(f(!e.isZero()),this.isZero())return{div:new c(0),mod:new c(0)};var h,d,g;return this.negative!==0&&e.negative===0?(g=this.neg().divmod(e,s),s!=="mod"&&(h=g.div.neg()),s!=="div"&&(d=g.mod.neg(),a&&d.negative!==0&&d.iadd(e)),{div:h,mod:d}):this.negative===0&&e.negative!==0?(g=this.divmod(e.neg(),s),s!=="mod"&&(h=g.div.neg()),{div:h,mod:g.mod}):(this.negative&e.negative)!==0?(g=this.neg().divmod(e.neg(),s),s!=="div"&&(d=g.mod.neg(),a&&d.negative!==0&&d.isub(e)),{div:g.div,mod:d}):e.length>this.length||this.cmp(e)<0?{div:new c(0),mod:this}:e.length===1?s==="div"?{div:this.divn(e.words[0]),mod:null}:s==="mod"?{div:null,mod:new c(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new c(this.modn(e.words[0]))}:this._wordDiv(e,s)},c.prototype.div=function(e){return this.divmod(e,"div",!1).div},c.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},c.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},c.prototype.divRound=function(e){var s=this.divmod(e);if(s.mod.isZero())return s.div;var a=s.div.negative!==0?s.mod.isub(e):s.mod,h=e.ushrn(1),d=e.andln(1),g=a.cmp(h);return g<0||d===1&&g===0?s.div:s.div.negative!==0?s.div.isubn(1):s.div.iaddn(1)},c.prototype.modn=function(e){f(e<=67108863);for(var s=(1<<26)%e,a=0,h=this.length-1;h>=0;h--)a=(s*a+(this.words[h]|0))%e;return a},c.prototype.idivn=function(e){f(e<=67108863);for(var s=0,a=this.length-1;a>=0;a--){var h=(this.words[a]|0)+s*67108864;this.words[a]=h/e|0,s=h%e}return this.strip()},c.prototype.divn=function(e){return this.clone().idivn(e)},c.prototype.egcd=function(e){f(e.negative===0),f(!e.isZero());var s=this,a=e.clone();s.negative!==0?s=s.umod(e):s=s.clone();for(var h=new c(1),d=new c(0),g=new c(0),m=new c(1),u=0;s.isEven()&&a.isEven();)s.iushrn(1),a.iushrn(1),++u;for(var n=a.clone(),l=s.clone();!s.isZero();){for(var F=0,A=1;(s.words[0]&A)===0&&F<26;++F,A<<=1);if(F>0)for(s.iushrn(F);F-- >0;)(h.isOdd()||d.isOdd())&&(h.iadd(n),d.isub(l)),h.iushrn(1),d.iushrn(1);for(var N=0,L=1;(a.words[0]&L)===0&&N<26;++N,L<<=1);if(N>0)for(a.iushrn(N);N-- >0;)(g.isOdd()||m.isOdd())&&(g.iadd(n),m.isub(l)),g.iushrn(1),m.iushrn(1);s.cmp(a)>=0?(s.isub(a),h.isub(g),d.isub(m)):(a.isub(s),g.isub(h),m.isub(d))}return{a:g,b:m,gcd:a.iushln(u)}},c.prototype._invmp=function(e){f(e.negative===0),f(!e.isZero());var s=this,a=e.clone();s.negative!==0?s=s.umod(e):s=s.clone();for(var h=new c(1),d=new c(0),g=a.clone();s.cmpn(1)>0&&a.cmpn(1)>0;){for(var m=0,u=1;(s.words[0]&u)===0&&m<26;++m,u<<=1);if(m>0)for(s.iushrn(m);m-- >0;)h.isOdd()&&h.iadd(g),h.iushrn(1);for(var n=0,l=1;(a.words[0]&l)===0&&n<26;++n,l<<=1);if(n>0)for(a.iushrn(n);n-- >0;)d.isOdd()&&d.iadd(g),d.iushrn(1);s.cmp(a)>=0?(s.isub(a),h.isub(d)):(a.isub(s),d.isub(h))}var F;return s.cmpn(1)===0?F=h:F=d,F.cmpn(0)<0&&F.iadd(e),F},c.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var s=this.clone(),a=e.clone();s.negative=0,a.negative=0;for(var h=0;s.isEven()&&a.isEven();h++)s.iushrn(1),a.iushrn(1);do{for(;s.isEven();)s.iushrn(1);for(;a.isEven();)a.iushrn(1);var d=s.cmp(a);if(d<0){var g=s;s=a,a=g}else if(d===0||a.cmpn(1)===0)break;s.isub(a)}while(!0);return a.iushln(h)},c.prototype.invm=function(e){return this.egcd(e).a.umod(e)},c.prototype.isEven=function(){return(this.words[0]&1)===0},c.prototype.isOdd=function(){return(this.words[0]&1)===1},c.prototype.andln=function(e){return this.words[0]&e},c.prototype.bincn=function(e){f(typeof e=="number");var s=e%26,a=(e-s)/26,h=1<<s;if(this.length<=a)return this._expand(a+1),this.words[a]|=h,this;for(var d=h,g=a;d!==0&&g<this.length;g++){var m=this.words[g]|0;m+=d,d=m>>>26,m&=67108863,this.words[g]=m}return d!==0&&(this.words[g]=d,this.length++),this},c.prototype.isZero=function(){return this.length===1&&this.words[0]===0},c.prototype.cmpn=function(e){var s=e<0;if(this.negative!==0&&!s)return-1;if(this.negative===0&&s)return 1;this.strip();var a;if(this.length>1)a=1;else{s&&(e=-e),f(e<=67108863,"Number is too big");var h=this.words[0]|0;a=h===e?0:h<e?-1:1}return this.negative!==0?-a|0:a},c.prototype.cmp=function(e){if(this.negative!==0&&e.negative===0)return-1;if(this.negative===0&&e.negative!==0)return 1;var s=this.ucmp(e);return this.negative!==0?-s|0:s},c.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var s=0,a=this.length-1;a>=0;a--){var h=this.words[a]|0,d=e.words[a]|0;if(h!==d){h<d?s=-1:h>d&&(s=1);break}}return s},c.prototype.gtn=function(e){return this.cmpn(e)===1},c.prototype.gt=function(e){return this.cmp(e)===1},c.prototype.gten=function(e){return this.cmpn(e)>=0},c.prototype.gte=function(e){return this.cmp(e)>=0},c.prototype.ltn=function(e){return this.cmpn(e)===-1},c.prototype.lt=function(e){return this.cmp(e)===-1},c.prototype.lten=function(e){return this.cmpn(e)<=0},c.prototype.lte=function(e){return this.cmp(e)<=0},c.prototype.eqn=function(e){return this.cmpn(e)===0},c.prototype.eq=function(e){return this.cmp(e)===0},c.red=function(e){return new J(e)},c.prototype.toRed=function(e){return f(!this.red,"Already a number in reduction context"),f(this.negative===0,"red works only with positives"),e.convertTo(this)._forceRed(e)},c.prototype.fromRed=function(){return f(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},c.prototype._forceRed=function(e){return this.red=e,this},c.prototype.forceRed=function(e){return f(!this.red,"Already a number in reduction context"),this._forceRed(e)},c.prototype.redAdd=function(e){return f(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},c.prototype.redIAdd=function(e){return f(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},c.prototype.redSub=function(e){return f(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},c.prototype.redISub=function(e){return f(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},c.prototype.redShl=function(e){return f(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},c.prototype.redMul=function(e){return f(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},c.prototype.redIMul=function(e){return f(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},c.prototype.redSqr=function(){return f(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},c.prototype.redISqr=function(){return f(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},c.prototype.redSqrt=function(){return f(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},c.prototype.redInvm=function(){return f(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},c.prototype.redNeg=function(){return f(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},c.prototype.redPow=function(e){return f(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var O={k256:null,p224:null,p192:null,p25519:null};function R(p,e){this.name=p,this.p=new c(e,16),this.n=this.p.bitLength(),this.k=new c(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}R.prototype._tmp=function(){var e=new c(null);return e.words=new Array(Math.ceil(this.n/13)),e},R.prototype.ireduce=function(e){var s=e,a;do this.split(s,this.tmp),s=this.imulK(s),s=s.iadd(this.tmp),a=s.bitLength();while(a>this.n);var h=a<this.n?-1:s.ucmp(this.p);return h===0?(s.words[0]=0,s.length=1):h>0?s.isub(this.p):s.strip(),s},R.prototype.split=function(e,s){e.iushrn(this.n,0,s)},R.prototype.imulK=function(e){return e.imul(this.k)};function W(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}v(W,R),W.prototype.split=function(e,s){for(var a=4194303,h=Math.min(e.length,9),d=0;d<h;d++)s.words[d]=e.words[d];if(s.length=h,e.length<=9){e.words[0]=0,e.length=1;return}var g=e.words[9];for(s.words[s.length++]=g&a,d=10;d<e.length;d++){var m=e.words[d]|0;e.words[d-10]=(m&a)<<4|g>>>22,g=m}g>>>=22,e.words[d-10]=g,g===0&&e.length>10?e.length-=10:e.length-=9},W.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var s=0,a=0;a<e.length;a++){var h=e.words[a]|0;s+=h*977,e.words[a]=s&67108863,s=h*64+(s/67108864|0)}return e.words[e.length-1]===0&&(e.length--,e.words[e.length-1]===0&&e.length--),e};function K(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}v(K,R);function D(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}v(D,R);function Et(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}v(Et,R),Et.prototype.imulK=function(e){for(var s=0,a=0;a<e.length;a++){var h=(e.words[a]|0)*19+s,d=h&67108863;h>>>=26,e.words[a]=d,s=h}return s!==0&&(e.words[e.length++]=s),e},c._prime=function(e){if(O[e])return O[e];var s;if(e==="k256")s=new W;else if(e==="p224")s=new K;else if(e==="p192")s=new D;else if(e==="p25519")s=new Et;else throw new Error("Unknown prime "+e);return O[e]=s,s};function J(p){if(typeof p=="string"){var e=c._prime(p);this.m=e.p,this.prime=e}else f(p.gtn(1),"modulus must be greater than 1"),this.m=p,this.prime=null}J.prototype._verify1=function(e){f(e.negative===0,"red works only with positives"),f(e.red,"red works only with red numbers")},J.prototype._verify2=function(e,s){f((e.negative|s.negative)===0,"red works only with positives"),f(e.red&&e.red===s.red,"red works only with red numbers")},J.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},J.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},J.prototype.add=function(e,s){this._verify2(e,s);var a=e.add(s);return a.cmp(this.m)>=0&&a.isub(this.m),a._forceRed(this)},J.prototype.iadd=function(e,s){this._verify2(e,s);var a=e.iadd(s);return a.cmp(this.m)>=0&&a.isub(this.m),a},J.prototype.sub=function(e,s){this._verify2(e,s);var a=e.sub(s);return a.cmpn(0)<0&&a.iadd(this.m),a._forceRed(this)},J.prototype.isub=function(e,s){this._verify2(e,s);var a=e.isub(s);return a.cmpn(0)<0&&a.iadd(this.m),a},J.prototype.shl=function(e,s){return this._verify1(e),this.imod(e.ushln(s))},J.prototype.imul=function(e,s){return this._verify2(e,s),this.imod(e.imul(s))},J.prototype.mul=function(e,s){return this._verify2(e,s),this.imod(e.mul(s))},J.prototype.isqr=function(e){return this.imul(e,e.clone())},J.prototype.sqr=function(e){return this.mul(e,e)},J.prototype.sqrt=function(e){if(e.isZero())return e.clone();var s=this.m.andln(3);if(f(s%2===1),s===3){var a=this.m.add(new c(1)).iushrn(2);return this.pow(e,a)}for(var h=this.m.subn(1),d=0;!h.isZero()&&h.andln(1)===0;)d++,h.iushrn(1);f(!h.isZero());var g=new c(1).toRed(this),m=g.redNeg(),u=this.m.subn(1).iushrn(1),n=this.m.bitLength();for(n=new c(2*n*n).toRed(this);this.pow(n,u).cmp(m)!==0;)n.redIAdd(m);for(var l=this.pow(n,h),F=this.pow(e,h.addn(1).iushrn(1)),A=this.pow(e,h),N=d;A.cmp(g)!==0;){for(var L=A,o=0;L.cmp(g)!==0;o++)L=L.redSqr();f(o<N);var w=this.pow(l,new c(1).iushln(N-o-1));F=F.redMul(w),l=w.redSqr(),A=A.redMul(l),N=o}return F},J.prototype.invm=function(e){var s=e._invmp(this.m);return s.negative!==0?(s.negative=0,this.imod(s).redNeg()):this.imod(s)},J.prototype.pow=function(e,s){if(s.isZero())return new c(1).toRed(this);if(s.cmpn(1)===0)return e.clone();var a=4,h=new Array(1<<a);h[0]=new c(1).toRed(this),h[1]=e;for(var d=2;d<h.length;d++)h[d]=this.mul(h[d-1],e);var g=h[0],m=0,u=0,n=s.bitLength()%26;for(n===0&&(n=26),d=s.length-1;d>=0;d--){for(var l=s.words[d],F=n-1;F>=0;F--){var A=l>>F&1;if(g!==h[0]&&(g=this.sqr(g)),A===0&&m===0){u=0;continue}m<<=1,m|=A,u++,!(u!==a&&(d!==0||F!==0))&&(g=this.mul(g,h[m]),u=0,m=0)}n=26}return g},J.prototype.convertTo=function(e){var s=e.umod(this.m);return s===e?s.clone():s},J.prototype.convertFrom=function(e){var s=e.clone();return s.red=null,s},c.mont=function(e){return new Tt(e)};function Tt(p){J.call(this,p),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new c(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v(Tt,J),Tt.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},Tt.prototype.convertFrom=function(e){var s=this.imod(e.mul(this.rinv));return s.red=null,s},Tt.prototype.imul=function(e,s){if(e.isZero()||s.isZero())return e.words[0]=0,e.length=1,e;var a=e.imul(s),h=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=a.isub(h).iushrn(this.shift),g=d;return d.cmp(this.m)>=0?g=d.isub(this.m):d.cmpn(0)<0&&(g=d.iadd(this.m)),g._forceRed(this)},Tt.prototype.mul=function(e,s){if(e.isZero()||s.isZero())return new c(0)._forceRed(this);var a=e.mul(s),h=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=a.isub(h).iushrn(this.shift),g=d;return d.cmp(this.m)>=0?g=d.isub(this.m):d.cmpn(0)<0&&(g=d.iadd(this.m)),g._forceRed(this)},Tt.prototype.invm=function(e){var s=this.imod(e._invmp(this.m).mul(this.r2));return s._forceRed(this)}})(i,mi)})(ge)),ge.exports}var wi=vi();const yi=gr(wi);var Be,ir;function Mr(){if(ir)return Be;ir=1,Be=r,r.strict=f,r.loose=v;var i=Object.prototype.toString,t={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function r(c){return f(c)||v(c)}function f(c){return c instanceof Int8Array||c instanceof Int16Array||c instanceof Int32Array||c instanceof Uint8Array||c instanceof Uint8ClampedArray||c instanceof Uint16Array||c instanceof Uint32Array||c instanceof Float32Array||c instanceof Float64Array}function v(c){return t[i.call(c)]}return Be}Mr();var Te,nr;function Mi(){if(nr)return Te;nr=1;var i=Mr().strict;return Te=function(r){if(i(r)){var f=me.from(r.buffer);return r.byteLength!==r.buffer.byteLength&&(f=f.slice(r.byteOffset,r.byteOffset+r.byteLength)),f}else return me.from(r)},Te}var bi=Mi();const _i=gr(bi),br="hex",_r="utf8",we="0";function fe(i){return new Uint8Array(i)}function Sr(i,t=!1){const r=i.toString(br);return t?ce(r):r}function Si(i){return i.toString(_r)}function ye(i){return _i(i)}function ae(i,t=!1){return Sr(ye(i),t)}function xi(i){return Si(ye(i))}function ki(i){return me.from(jt(i),br)}function he(i){return fe(ki(i))}function Ke(i){return me.from(i,_r)}function Ri(i){return fe(Ke(i))}function Oi(i,t=!1){return Sr(Ke(i),t)}function Ai(i,t){return!(typeof i!="string"||!i.match(/^0x[0-9A-Fa-f]*$/))}function xr(...i){let t=[];return i.forEach(r=>t=t.concat(Array.from(r))),new Uint8Array([...t])}function Ei(i,t=8){const r=i%t;return r?(i-r)/t*t+t:i}function Ii(i,t=8,r=we){return Bi(i,Ei(i.length,t),r)}function Bi(i,t,r=we){return Fi(i,t,!0,r)}function jt(i){return i.replace(/^0x/,"")}function ce(i){return i.startsWith("0x")?i:`0x${i}`}function kr(i){return i=jt(i),i=Ii(i,2),i&&(i=ce(i)),i}function Ti(i){const t=i.startsWith("0x");return i=jt(i),i=i.startsWith(we)?i.substring(1):i,t?ce(i):i}function Fi(i,t,r,f=we){const v=t-i.length;let c=i;return v>0&&(c=f.repeat(v)+i),c}function De(i){return ye(new Uint8Array(i))}function Ci(i,t){return ae(new Uint8Array(i),!1)}function Ni(i){return fe(i).buffer}function qi(i){return Ke(i)}function Pi(i,t){return Oi(i,!0)}function Li(i){return he(i).buffer}function Rr(i,t){const r=jt(kr(new yi(i).toString(16)));return t?r:ce(r)}var Fe={exports:{}},sr;function Wi(){return sr||(sr=1,(function(i){(function(){var t="input is invalid type",r="finalize already called",f=typeof window=="object",v=f?window:{};v.JS_SHA3_NO_WINDOW&&(f=!1);var c=!f&&typeof self=="object",k=!v.JS_SHA3_NO_NODE_JS&&typeof oe=="object"&&oe.versions&&oe.versions.node;k?v=Lr:c&&(v=self);var C=!v.JS_SHA3_NO_COMMON_JS&&!0&&i.exports,E=!v.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",P="0123456789abcdef".split(""),H=[31,7936,2031616,520093696],Rt=[4,1024,262144,67108864],kt=[1,256,65536,16777216],j=[6,1536,393216,100663296],$=[0,8,16,24],It=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],b=[224,256,384,512],S=[128,256],O=["hex","buffer","arrayBuffer","array","digest"],R={128:168,256:136};(v.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(o){return Object.prototype.toString.call(o)==="[object Array]"}),E&&(v.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(o){return typeof o=="object"&&o.buffer&&o.buffer.constructor===ArrayBuffer});for(var W=function(o,w,_){return function(y){return new A(o,w,o).update(y)[_]()}},K=function(o,w,_){return function(y,x){return new A(o,w,x).update(y)[_]()}},D=function(o,w,_){return function(y,x,q,B){return h["cshake"+o].update(y,x,q,B)[_]()}},Et=function(o,w,_){return function(y,x,q,B){return h["kmac"+o].update(y,x,q,B)[_]()}},J=function(o,w,_,y){for(var x=0;x<O.length;++x){var q=O[x];o[q]=w(_,y,q)}return o},Tt=function(o,w){var _=W(o,w,"hex");return _.create=function(){return new A(o,w,o)},_.update=function(y){return _.create().update(y)},J(_,W,o,w)},p=function(o,w){var _=K(o,w,"hex");return _.create=function(y){return new A(o,w,y)},_.update=function(y,x){return _.create(x).update(y)},J(_,K,o,w)},e=function(o,w){var _=R[o],y=D(o,w,"hex");return y.create=function(x,q,B){return!q&&!B?h["shake"+o].create(x):new A(o,w,x).bytepad([q,B],_)},y.update=function(x,q,B,I){return y.create(q,B,I).update(x)},J(y,D,o,w)},s=function(o,w){var _=R[o],y=Et(o,w,"hex");return y.create=function(x,q,B){return new N(o,w,q).bytepad(["KMAC",B],_).bytepad([x],_)},y.update=function(x,q,B,I){return y.create(x,B,I).update(q)},J(y,Et,o,w)},a=[{name:"keccak",padding:kt,bits:b,createMethod:Tt},{name:"sha3",padding:j,bits:b,createMethod:Tt},{name:"shake",padding:H,bits:S,createMethod:p},{name:"cshake",padding:Rt,bits:S,createMethod:e},{name:"kmac",padding:Rt,bits:S,createMethod:s}],h={},d=[],g=0;g<a.length;++g)for(var m=a[g],u=m.bits,n=0;n<u.length;++n){var l=m.name+"_"+u[n];if(d.push(l),h[l]=m.createMethod(u[n],m.padding),m.name!=="sha3"){var F=m.name+u[n];d.push(F),h[F]=h[l]}}function A(o,w,_){this.blocks=[],this.s=[],this.padding=w,this.outputBits=_,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(o<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=_>>5,this.extraBytes=(_&31)>>3;for(var y=0;y<50;++y)this.s[y]=0}A.prototype.update=function(o){if(this.finalized)throw new Error(r);var w,_=typeof o;if(_!=="string"){if(_==="object"){if(o===null)throw new Error(t);if(E&&o.constructor===ArrayBuffer)o=new Uint8Array(o);else if(!Array.isArray(o)&&(!E||!ArrayBuffer.isView(o)))throw new Error(t)}else throw new Error(t);w=!0}for(var y=this.blocks,x=this.byteCount,q=o.length,B=this.blockCount,I=0,Ot=this.s,T,U;I<q;){if(this.reset)for(this.reset=!1,y[0]=this.block,T=1;T<B+1;++T)y[T]=0;if(w)for(T=this.start;I<q&&T<x;++I)y[T>>2]|=o[I]<<$[T++&3];else for(T=this.start;I<q&&T<x;++I)U=o.charCodeAt(I),U<128?y[T>>2]|=U<<$[T++&3]:U<2048?(y[T>>2]|=(192|U>>6)<<$[T++&3],y[T>>2]|=(128|U&63)<<$[T++&3]):U<55296||U>=57344?(y[T>>2]|=(224|U>>12)<<$[T++&3],y[T>>2]|=(128|U>>6&63)<<$[T++&3],y[T>>2]|=(128|U&63)<<$[T++&3]):(U=65536+((U&1023)<<10|o.charCodeAt(++I)&1023),y[T>>2]|=(240|U>>18)<<$[T++&3],y[T>>2]|=(128|U>>12&63)<<$[T++&3],y[T>>2]|=(128|U>>6&63)<<$[T++&3],y[T>>2]|=(128|U&63)<<$[T++&3]);if(this.lastByteIndex=T,T>=x){for(this.start=T-x,this.block=y[B],T=0;T<B;++T)Ot[T]^=y[T];L(Ot),this.reset=!0}else this.start=T}return this},A.prototype.encode=function(o,w){var _=o&255,y=1,x=[_];for(o=o>>8,_=o&255;_>0;)x.unshift(_),o=o>>8,_=o&255,++y;return w?x.push(y):x.unshift(y),this.update(x),x.length},A.prototype.encodeString=function(o){var w,_=typeof o;if(_!=="string"){if(_==="object"){if(o===null)throw new Error(t);if(E&&o.constructor===ArrayBuffer)o=new Uint8Array(o);else if(!Array.isArray(o)&&(!E||!ArrayBuffer.isView(o)))throw new Error(t)}else throw new Error(t);w=!0}var y=0,x=o.length;if(w)y=x;else for(var q=0;q<o.length;++q){var B=o.charCodeAt(q);B<128?y+=1:B<2048?y+=2:B<55296||B>=57344?y+=3:(B=65536+((B&1023)<<10|o.charCodeAt(++q)&1023),y+=4)}return y+=this.encode(y*8),this.update(o),y},A.prototype.bytepad=function(o,w){for(var _=this.encode(w),y=0;y<o.length;++y)_+=this.encodeString(o[y]);var x=w-_%w,q=[];return q.length=x,this.update(q),this},A.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var o=this.blocks,w=this.lastByteIndex,_=this.blockCount,y=this.s;if(o[w>>2]|=this.padding[w&3],this.lastByteIndex===this.byteCount)for(o[0]=o[_],w=1;w<_+1;++w)o[w]=0;for(o[_-1]|=2147483648,w=0;w<_;++w)y[w]^=o[w];L(y)}},A.prototype.toString=A.prototype.hex=function(){this.finalize();for(var o=this.blockCount,w=this.s,_=this.outputBlocks,y=this.extraBytes,x=0,q=0,B="",I;q<_;){for(x=0;x<o&&q<_;++x,++q)I=w[x],B+=P[I>>4&15]+P[I&15]+P[I>>12&15]+P[I>>8&15]+P[I>>20&15]+P[I>>16&15]+P[I>>28&15]+P[I>>24&15];q%o===0&&(L(w),x=0)}return y&&(I=w[x],B+=P[I>>4&15]+P[I&15],y>1&&(B+=P[I>>12&15]+P[I>>8&15]),y>2&&(B+=P[I>>20&15]+P[I>>16&15])),B},A.prototype.arrayBuffer=function(){this.finalize();var o=this.blockCount,w=this.s,_=this.outputBlocks,y=this.extraBytes,x=0,q=0,B=this.outputBits>>3,I;y?I=new ArrayBuffer(_+1<<2):I=new ArrayBuffer(B);for(var Ot=new Uint32Array(I);q<_;){for(x=0;x<o&&q<_;++x,++q)Ot[q]=w[x];q%o===0&&L(w)}return y&&(Ot[x]=w[x],I=I.slice(0,B)),I},A.prototype.buffer=A.prototype.arrayBuffer,A.prototype.digest=A.prototype.array=function(){this.finalize();for(var o=this.blockCount,w=this.s,_=this.outputBlocks,y=this.extraBytes,x=0,q=0,B=[],I,Ot;q<_;){for(x=0;x<o&&q<_;++x,++q)I=q<<2,Ot=w[x],B[I]=Ot&255,B[I+1]=Ot>>8&255,B[I+2]=Ot>>16&255,B[I+3]=Ot>>24&255;q%o===0&&L(w)}return y&&(I=q<<2,Ot=w[x],B[I]=Ot&255,y>1&&(B[I+1]=Ot>>8&255),y>2&&(B[I+2]=Ot>>16&255)),B};function N(o,w,_){A.call(this,o,w,_)}N.prototype=new A,N.prototype.finalize=function(){return this.encode(this.outputBits,!0),A.prototype.finalize.call(this)};var L=function(o){var w,_,y,x,q,B,I,Ot,T,U,zt,G,Z,Vt,Q,X,$t,Y,tt,Kt,et,rt,Jt,it,nt,Gt,st,ot,Zt,at,ht,Qt,ft,ct,Xt,ut,lt,Yt,dt,pt,te,gt,mt,ee,vt,wt,re,yt,Mt,ie,bt,_t,ne,St,xt,Ft,Ct,Nt,qt,Pt,Lt,Wt,Ut;for(y=0;y<48;y+=2)x=o[0]^o[10]^o[20]^o[30]^o[40],q=o[1]^o[11]^o[21]^o[31]^o[41],B=o[2]^o[12]^o[22]^o[32]^o[42],I=o[3]^o[13]^o[23]^o[33]^o[43],Ot=o[4]^o[14]^o[24]^o[34]^o[44],T=o[5]^o[15]^o[25]^o[35]^o[45],U=o[6]^o[16]^o[26]^o[36]^o[46],zt=o[7]^o[17]^o[27]^o[37]^o[47],G=o[8]^o[18]^o[28]^o[38]^o[48],Z=o[9]^o[19]^o[29]^o[39]^o[49],w=G^(B<<1|I>>>31),_=Z^(I<<1|B>>>31),o[0]^=w,o[1]^=_,o[10]^=w,o[11]^=_,o[20]^=w,o[21]^=_,o[30]^=w,o[31]^=_,o[40]^=w,o[41]^=_,w=x^(Ot<<1|T>>>31),_=q^(T<<1|Ot>>>31),o[2]^=w,o[3]^=_,o[12]^=w,o[13]^=_,o[22]^=w,o[23]^=_,o[32]^=w,o[33]^=_,o[42]^=w,o[43]^=_,w=B^(U<<1|zt>>>31),_=I^(zt<<1|U>>>31),o[4]^=w,o[5]^=_,o[14]^=w,o[15]^=_,o[24]^=w,o[25]^=_,o[34]^=w,o[35]^=_,o[44]^=w,o[45]^=_,w=Ot^(G<<1|Z>>>31),_=T^(Z<<1|G>>>31),o[6]^=w,o[7]^=_,o[16]^=w,o[17]^=_,o[26]^=w,o[27]^=_,o[36]^=w,o[37]^=_,o[46]^=w,o[47]^=_,w=U^(x<<1|q>>>31),_=zt^(q<<1|x>>>31),o[8]^=w,o[9]^=_,o[18]^=w,o[19]^=_,o[28]^=w,o[29]^=_,o[38]^=w,o[39]^=_,o[48]^=w,o[49]^=_,Vt=o[0],Q=o[1],wt=o[11]<<4|o[10]>>>28,re=o[10]<<4|o[11]>>>28,ot=o[20]<<3|o[21]>>>29,Zt=o[21]<<3|o[20]>>>29,Pt=o[31]<<9|o[30]>>>23,Lt=o[30]<<9|o[31]>>>23,gt=o[40]<<18|o[41]>>>14,mt=o[41]<<18|o[40]>>>14,ct=o[2]<<1|o[3]>>>31,Xt=o[3]<<1|o[2]>>>31,X=o[13]<<12|o[12]>>>20,$t=o[12]<<12|o[13]>>>20,yt=o[22]<<10|o[23]>>>22,Mt=o[23]<<10|o[22]>>>22,at=o[33]<<13|o[32]>>>19,ht=o[32]<<13|o[33]>>>19,Wt=o[42]<<2|o[43]>>>30,Ut=o[43]<<2|o[42]>>>30,St=o[5]<<30|o[4]>>>2,xt=o[4]<<30|o[5]>>>2,ut=o[14]<<6|o[15]>>>26,lt=o[15]<<6|o[14]>>>26,Y=o[25]<<11|o[24]>>>21,tt=o[24]<<11|o[25]>>>21,ie=o[34]<<15|o[35]>>>17,bt=o[35]<<15|o[34]>>>17,Qt=o[45]<<29|o[44]>>>3,ft=o[44]<<29|o[45]>>>3,it=o[6]<<28|o[7]>>>4,nt=o[7]<<28|o[6]>>>4,Ft=o[17]<<23|o[16]>>>9,Ct=o[16]<<23|o[17]>>>9,Yt=o[26]<<25|o[27]>>>7,dt=o[27]<<25|o[26]>>>7,Kt=o[36]<<21|o[37]>>>11,et=o[37]<<21|o[36]>>>11,_t=o[47]<<24|o[46]>>>8,ne=o[46]<<24|o[47]>>>8,ee=o[8]<<27|o[9]>>>5,vt=o[9]<<27|o[8]>>>5,Gt=o[18]<<20|o[19]>>>12,st=o[19]<<20|o[18]>>>12,Nt=o[29]<<7|o[28]>>>25,qt=o[28]<<7|o[29]>>>25,pt=o[38]<<8|o[39]>>>24,te=o[39]<<8|o[38]>>>24,rt=o[48]<<14|o[49]>>>18,Jt=o[49]<<14|o[48]>>>18,o[0]=Vt^~X&Y,o[1]=Q^~$t&tt,o[10]=it^~Gt&ot,o[11]=nt^~st&Zt,o[20]=ct^~ut&Yt,o[21]=Xt^~lt&dt,o[30]=ee^~wt&yt,o[31]=vt^~re&Mt,o[40]=St^~Ft&Nt,o[41]=xt^~Ct&qt,o[2]=X^~Y&Kt,o[3]=$t^~tt&et,o[12]=Gt^~ot&at,o[13]=st^~Zt&ht,o[22]=ut^~Yt&pt,o[23]=lt^~dt&te,o[32]=wt^~yt&ie,o[33]=re^~Mt&bt,o[42]=Ft^~Nt&Pt,o[43]=Ct^~qt&Lt,o[4]=Y^~Kt&rt,o[5]=tt^~et&Jt,o[14]=ot^~at&Qt,o[15]=Zt^~ht&ft,o[24]=Yt^~pt&gt,o[25]=dt^~te&mt,o[34]=yt^~ie&_t,o[35]=Mt^~bt&ne,o[44]=Nt^~Pt&Wt,o[45]=qt^~Lt&Ut,o[6]=Kt^~rt&Vt,o[7]=et^~Jt&Q,o[16]=at^~Qt&it,o[17]=ht^~ft&nt,o[26]=pt^~gt&ct,o[27]=te^~mt&Xt,o[36]=ie^~_t&ee,o[37]=bt^~ne&vt,o[46]=Pt^~Wt&St,o[47]=Lt^~Ut&xt,o[8]=rt^~Vt&X,o[9]=Jt^~Q&$t,o[18]=Qt^~it&Gt,o[19]=ft^~nt&st,o[28]=gt^~ct&ut,o[29]=mt^~Xt&lt,o[38]=_t^~ee&wt,o[39]=ne^~vt&re,o[48]=Wt^~St&Ft,o[49]=Ut^~xt&Ct,o[0]^=It[y],o[1]^=It[y+1]};if(C)i.exports=h;else for(g=0;g<d.length;++g)v[d[g]]=h[d[g]]})()})(Fe)),Fe.exports}var Ui=Wi();function pe(i){return kr(i)}function Di(i){return Ti(ce(i))}const ji=Wr;function Ce(){return((t,r)=>{for(r=t="";t++<36;r+=t*51&52?(t^15?8^Math.random()*(t^20?16:4):4).toString(16):"-");return r})()}function Hi(i){return i===""||typeof i=="string"&&i.trim()===""}function zi(i){return!(i&&i.length)}function Or(i,t){return Ai(i)}function Vi(i){return typeof i.method<"u"}function le(i){return typeof i.result<"u"}function ve(i){return typeof i.error<"u"}function or(i){return typeof i.event<"u"}function $i(i){return gi.includes(i)||i.startsWith("wc_")}function Ki(i){return i.method.startsWith("wc_")?!0:!yr.includes(i.method)}function Ji(i){i=jt(i.toLowerCase());const t=jt(Ui.keccak_256(qi(i)));let r="";for(let f=0;f<i.length;f++)parseInt(t[f],16)>7?r+=i[f].toUpperCase():r+=i[f];return ce(r)}const Gi=i=>i?i.toLowerCase().substring(0,2)!=="0x"?!1:/^(0x)?[0-9a-f]{40}$/i.test(i)?/^(0x)?[0-9a-f]{40}$/.test(i)||/^(0x)?[0-9A-F]{40}$/.test(i)?!0:i===Ji(i):!1:!1;function ar(i){return!zi(i)&&!Or(i[0])&&(i[0]=Pi(i[0])),i}function Ne(i){if(typeof i.type<"u"&&i.type!=="0")return i;if(typeof i.from>"u"||!Gi(i.from))throw new Error("Transaction object must include a valid 'from' value.");function t(v){let c=v;return(typeof v=="number"||typeof v=="string"&&!Hi(v))&&(Or(v)?typeof v=="string"&&(c=pe(v)):c=Rr(v)),typeof c=="string"&&(c=Di(c)),c}const r={from:pe(i.from),to:typeof i.to>"u"?void 0:pe(i.to),gasPrice:typeof i.gasPrice>"u"?"":t(i.gasPrice),gas:typeof i.gas>"u"?typeof i.gasLimit>"u"?"":t(i.gasLimit):t(i.gas),value:typeof i.value>"u"?"":t(i.value),nonce:typeof i.nonce>"u"?"":t(i.nonce),data:typeof i.data>"u"?"":pe(i.data)||"0x"},f=["gasPrice","gas","value","nonce"];return Object.keys(r).forEach(v=>{(typeof r[v]>"u"||typeof r[v]=="string"&&!r[v].trim().length)&&f.includes(v)&&delete r[v]}),r}function Zi(i){const t=i.message||"Failed or Rejected Request";let r=-32e3;if(i&&!i.code)switch(t){case"Parse error":r=-32700;break;case"Invalid request":r=-32600;break;case"Method not found":r=-32601;break;case"Invalid params":r=-32602;break;case"Internal error":r=-32603;break;default:r=-32e3;break}const f={code:r,message:t};return i.data&&(f.data=i.data),f}var qe={},Pe,hr;function Qi(){return hr||(hr=1,Pe=i=>encodeURIComponent(i).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`)),Pe}var Le,fr;function Xi(){if(fr)return Le;fr=1;var i="%[a-f0-9]{2}",t=new RegExp("("+i+")|([^%]+?)","gi"),r=new RegExp("("+i+")+","gi");function f(k,C){try{return[decodeURIComponent(k.join(""))]}catch{}if(k.length===1)return k;C=C||1;var E=k.slice(0,C),P=k.slice(C);return Array.prototype.concat.call([],f(E),f(P))}function v(k){try{return decodeURIComponent(k)}catch{for(var C=k.match(t)||[],E=1;E<C.length;E++)k=f(C,E).join(""),C=k.match(t)||[];return k}}function c(k){for(var C={"%FE%FF":"","%FF%FE":""},E=r.exec(k);E;){try{C[E[0]]=decodeURIComponent(E[0])}catch{var P=v(E[0]);P!==E[0]&&(C[E[0]]=P)}E=r.exec(k)}C["%C2"]="";for(var H=Object.keys(C),Rt=0;Rt<H.length;Rt++){var kt=H[Rt];k=k.replace(new RegExp(kt,"g"),C[kt])}return k}return Le=function(k){if(typeof k!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof k+"`");try{return k=k.replace(/\+/g," "),decodeURIComponent(k)}catch{return c(k)}},Le}var We,cr;function Yi(){return cr||(cr=1,We=(i,t)=>{if(!(typeof i=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[i];const r=i.indexOf(t);return r===-1?[i]:[i.slice(0,r),i.slice(r+t.length)]}),We}var ur;function tn(){return ur||(ur=1,(function(i){const t=Qi(),r=Xi(),f=Yi(),v=b=>b==null;function c(b){switch(b.arrayFormat){case"index":return S=>(O,R)=>{const W=O.length;return R===void 0||b.skipNull&&R===null||b.skipEmptyString&&R===""?O:R===null?[...O,[E(S,b),"[",W,"]"].join("")]:[...O,[E(S,b),"[",E(W,b),"]=",E(R,b)].join("")]};case"bracket":return S=>(O,R)=>R===void 0||b.skipNull&&R===null||b.skipEmptyString&&R===""?O:R===null?[...O,[E(S,b),"[]"].join("")]:[...O,[E(S,b),"[]=",E(R,b)].join("")];case"comma":case"separator":return S=>(O,R)=>R==null||R.length===0?O:O.length===0?[[E(S,b),"=",E(R,b)].join("")]:[[O,E(R,b)].join(b.arrayFormatSeparator)];default:return S=>(O,R)=>R===void 0||b.skipNull&&R===null||b.skipEmptyString&&R===""?O:R===null?[...O,E(S,b)]:[...O,[E(S,b),"=",E(R,b)].join("")]}}function k(b){let S;switch(b.arrayFormat){case"index":return(O,R,W)=>{if(S=/\[(\d*)\]$/.exec(O),O=O.replace(/\[\d*\]$/,""),!S){W[O]=R;return}W[O]===void 0&&(W[O]={}),W[O][S[1]]=R};case"bracket":return(O,R,W)=>{if(S=/(\[\])$/.exec(O),O=O.replace(/\[\]$/,""),!S){W[O]=R;return}if(W[O]===void 0){W[O]=[R];return}W[O]=[].concat(W[O],R)};case"comma":case"separator":return(O,R,W)=>{const D=typeof R=="string"&&R.split("").indexOf(b.arrayFormatSeparator)>-1?R.split(b.arrayFormatSeparator).map(Et=>P(Et,b)):R===null?R:P(R,b);W[O]=D};default:return(O,R,W)=>{if(W[O]===void 0){W[O]=R;return}W[O]=[].concat(W[O],R)}}}function C(b){if(typeof b!="string"||b.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function E(b,S){return S.encode?S.strict?t(b):encodeURIComponent(b):b}function P(b,S){return S.decode?r(b):b}function H(b){return Array.isArray(b)?b.sort():typeof b=="object"?H(Object.keys(b)).sort((S,O)=>Number(S)-Number(O)).map(S=>b[S]):b}function Rt(b){const S=b.indexOf("#");return S!==-1&&(b=b.slice(0,S)),b}function kt(b){let S="";const O=b.indexOf("#");return O!==-1&&(S=b.slice(O)),S}function j(b){b=Rt(b);const S=b.indexOf("?");return S===-1?"":b.slice(S+1)}function $(b,S){return S.parseNumbers&&!Number.isNaN(Number(b))&&typeof b=="string"&&b.trim()!==""?b=Number(b):S.parseBooleans&&b!==null&&(b.toLowerCase()==="true"||b.toLowerCase()==="false")&&(b=b.toLowerCase()==="true"),b}function It(b,S){S=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},S),C(S.arrayFormatSeparator);const O=k(S),R=Object.create(null);if(typeof b!="string"||(b=b.trim().replace(/^[?#&]/,""),!b))return R;for(const W of b.split("&")){let[K,D]=f(S.decode?W.replace(/\+/g," "):W,"=");D=D===void 0?null:["comma","separator"].includes(S.arrayFormat)?D:P(D,S),O(P(K,S),D,R)}for(const W of Object.keys(R)){const K=R[W];if(typeof K=="object"&&K!==null)for(const D of Object.keys(K))K[D]=$(K[D],S);else R[W]=$(K,S)}return S.sort===!1?R:(S.sort===!0?Object.keys(R).sort():Object.keys(R).sort(S.sort)).reduce((W,K)=>{const D=R[K];return D&&typeof D=="object"&&!Array.isArray(D)?W[K]=H(D):W[K]=D,W},Object.create(null))}i.extract=j,i.parse=It,i.stringify=(b,S)=>{if(!b)return"";S=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},S),C(S.arrayFormatSeparator);const O=D=>S.skipNull&&v(b[D])||S.skipEmptyString&&b[D]==="",R=c(S),W={};for(const D of Object.keys(b))O(D)||(W[D]=b[D]);const K=Object.keys(W);return S.sort!==!1&&K.sort(S.sort),K.map(D=>{const Et=b[D];return Et===void 0?"":Et===null?E(D,S):Array.isArray(Et)?Et.reduce(R(D),[]).join("&"):E(D,S)+"="+E(Et,S)}).filter(D=>D.length>0).join("&")},i.parseUrl=(b,S)=>{S=Object.assign({decode:!0},S);const[O,R]=f(b,"#");return Object.assign({url:O.split("?")[0]||"",query:It(j(b),S)},S&&S.parseFragmentIdentifier&&R?{fragmentIdentifier:P(R,S)}:{})},i.stringifyUrl=(b,S)=>{S=Object.assign({encode:!0,strict:!0},S);const O=Rt(b.url).split("?")[0]||"",R=i.extract(b.url),W=i.parse(R,{sort:!1}),K=Object.assign(W,b.query);let D=i.stringify(K,S);D&&(D=`?${D}`);let Et=kt(b.url);return b.fragmentIdentifier&&(Et=`#${E(b.fragmentIdentifier,S)}`),`${O}${D}${Et}`}})(qe)),qe}var Ar=tn();function en(i){const t=i.indexOf("?")!==-1?i.indexOf("?"):void 0;return typeof t<"u"?i.substr(t):""}function rn(i,t){let r=Er(i);return r=Object.assign(Object.assign({},r),t),i=nn(r),i}function Er(i){return Ar.parse(i)}function nn(i){return Ar.stringify(i)}function sn(i){return typeof i.bridge<"u"}function on(i){const t=i.indexOf(":"),r=i.indexOf("?")!==-1?i.indexOf("?"):void 0,f=i.substring(0,t),v=i.substring(t+1,r);function c(Rt){const j=Rt.split("@");return{handshakeTopic:j[0],version:parseInt(j[1],10)}}const k=c(v),C=typeof r<"u"?i.substr(r):"";function E(Rt){const kt=Er(Rt);return{key:kt.key||"",bridge:kt.bridge||""}}const P=E(C);return Object.assign(Object.assign({protocol:f},k),P)}class an{constructor(){this._eventEmitters=[],typeof window<"u"&&typeof window.addEventListener<"u"&&(window.addEventListener("online",()=>this.trigger("online")),window.addEventListener("offline",()=>this.trigger("offline")))}on(t,r){this._eventEmitters.push({event:t,callback:r})}trigger(t){let r=[];t&&(r=this._eventEmitters.filter(f=>f.event===t)),r.forEach(f=>{f.callback()})}}const hn=typeof Ge.WebSocket<"u"?Ge.WebSocket:require("ws");class fn{constructor(t){if(this.opts=t,this._queue=[],this._events=[],this._subscriptions=[],this._protocol=t.protocol,this._version=t.version,this._url="",this._netMonitor=null,this._socket=null,this._nextSocket=null,this._subscriptions=t.subscriptions||[],this._netMonitor=t.netMonitor||new an,!t.url||typeof t.url!="string")throw new Error("Missing or invalid WebSocket url");this._url=t.url,this._netMonitor.on("online",()=>this._socketCreate())}set readyState(t){}get readyState(){return this._socket?this._socket.readyState:-1}set connecting(t){}get connecting(){return this.readyState===0}set connected(t){}get connected(){return this.readyState===1}set closing(t){}get closing(){return this.readyState===2}set closed(t){}get closed(){return this.readyState===3}open(){this._socketCreate()}close(){this._socketClose()}send(t,r,f){if(!r||typeof r!="string")throw new Error("Missing or invalid topic field");this._socketSend({topic:r,type:"pub",payload:t,silent:!!f})}subscribe(t){this._socketSend({topic:t,type:"sub",payload:"",silent:!0})}on(t,r){this._events.push({event:t,callback:r})}_socketCreate(){if(this._nextSocket)return;const t=cn(this._url,this._protocol,this._version);if(this._nextSocket=new hn(t),!this._nextSocket)throw new Error("Failed to create socket");this._nextSocket.onmessage=r=>this._socketReceive(r),this._nextSocket.onopen=()=>this._socketOpen(),this._nextSocket.onerror=r=>this._socketError(r),this._nextSocket.onclose=()=>{setTimeout(()=>{this._nextSocket=null,this._socketCreate()},1e3)}}_socketOpen(){this._socketClose(),this._socket=this._nextSocket,this._nextSocket=null,this._queueSubscriptions(),this._pushQueue()}_socketClose(){this._socket&&(this._socket.onclose=()=>{},this._socket.close())}_socketSend(t){const r=JSON.stringify(t);this._socket&&this._socket.readyState===1?this._socket.send(r):(this._setToQueue(t),this._socketCreate())}async _socketReceive(t){let r;try{r=JSON.parse(t.data)}catch{return}if(this._socketSend({topic:r.topic,type:"ack",payload:"",silent:!0}),this._socket&&this._socket.readyState===1){const f=this._events.filter(v=>v.event==="message");f&&f.length&&f.forEach(v=>v.callback(r))}}_socketError(t){const r=this._events.filter(f=>f.event==="error");r&&r.length&&r.forEach(f=>f.callback(t))}_queueSubscriptions(){this._subscriptions.forEach(r=>this._queue.push({topic:r,type:"sub",payload:"",silent:!0})),this._subscriptions=this.opts.subscriptions||[]}_setToQueue(t){this._queue.push(t)}_pushQueue(){this._queue.forEach(r=>this._socketSend(r)),this._queue=[]}}function cn(i,t,r){var f,v;const k=(i.startsWith("https")?i.replace("https","wss"):i.startsWith("http")?i.replace("http","ws"):i).split("?"),C=ai()?{protocol:t,version:r,env:"browser",host:((f=fi())===null||f===void 0?void 0:f.host)||""}:{protocol:t,version:r,env:((v=ze())===null||v===void 0?void 0:v.name)||""},E=rn(en(k[1]||""),C);return k[0]+"?"+E}const Ue="Session currently connected",se="Session currently disconnected",un="Session Rejected",ln="Missing JSON RPC response",dn='JSON-RPC success response must include "result" field',pn='JSON-RPC error response must include "error" field',gn='JSON RPC request must have valid "method" value',mn='JSON RPC request must have valid "id" value',vn="Missing one of the required parameters: bridge / uri / session",lr="JSON RPC response format is invalid",wn="URI format is invalid",yn="QRCode Modal not provided",dr="User close QRCode Modal";class Mn{constructor(){this._eventEmitters=[]}subscribe(t){this._eventEmitters.push(t)}unsubscribe(t){this._eventEmitters=this._eventEmitters.filter(r=>r.event!==t)}trigger(t){let r=[],f;Vi(t)?f=t.method:le(t)||ve(t)?f=`response:${t.id}`:or(t)?f=t.event:f="",f&&(r=this._eventEmitters.filter(v=>v.event===f)),(!r||!r.length)&&!$i(f)&&!or(f)&&(r=this._eventEmitters.filter(v=>v.event==="call_request")),r.forEach(v=>{if(ve(t)){const c=new Error(t.error.message);v.callback(c,null)}else v.callback(null,t)})}}class bn{constructor(t="walletconnect"){this.storageId=t}getSession(){let t=null;const r=vr(this.storageId);return r&&sn(r)&&(t=r),t}setSession(t){return pi(this.storageId,t),t}removeSession(){wr(this.storageId)}}const _n="walletconnect.org",Sn="abcdefghijklmnopqrstuvwxyz0123456789",Ir=Sn.split("").map(i=>`https://${i}.bridge.walletconnect.org`);function xn(i){let t=i.indexOf("//")>-1?i.split("/")[2]:i.split("/")[0];return t=t.split(":")[0],t=t.split("?")[0],t}function kn(i){return xn(i).split(".").slice(-2).join(".")}function Rn(){return Math.floor(Math.random()*Ir.length)}function On(){return Ir[Rn()]}function An(i){return kn(i)===_n}function En(i){return An(i)?On():i}class In{constructor(t){if(this.protocol="wc",this.version=1,this._bridge="",this._key=null,this._clientId="",this._clientMeta=null,this._peerId="",this._peerMeta=null,this._handshakeId=0,this._handshakeTopic="",this._connected=!1,this._accounts=[],this._chainId=0,this._networkId=0,this._rpcUrl="",this._eventManager=new Mn,this._clientMeta=tr()||t.connectorOpts.clientMeta||null,this._cryptoLib=t.cryptoLib,this._sessionStorage=t.sessionStorage||new bn(t.connectorOpts.storageId),this._qrcodeModal=t.connectorOpts.qrcodeModal,this._qrcodeModalOptions=t.connectorOpts.qrcodeModalOptions,this._signingMethods=[...yr,...t.connectorOpts.signingMethods||[]],!t.connectorOpts.bridge&&!t.connectorOpts.uri&&!t.connectorOpts.session)throw new Error(vn);t.connectorOpts.bridge&&(this.bridge=En(t.connectorOpts.bridge)),t.connectorOpts.uri&&(this.uri=t.connectorOpts.uri);const r=t.connectorOpts.session||this._getStorageSession();r&&(this.session=r),this.handshakeId&&this._subscribeToSessionResponse(this.handshakeId,"Session request rejected"),this._transport=t.transport||new fn({protocol:this.protocol,version:this.version,url:this.bridge,subscriptions:[this.clientId]}),this._subscribeToInternalEvents(),this._initTransport(),t.connectorOpts.uri&&this._subscribeToSessionRequest(),t.pushServerOpts&&this._registerPushServer(t.pushServerOpts)}set bridge(t){t&&(this._bridge=t)}get bridge(){return this._bridge}set key(t){if(!t)return;const r=Li(t);this._key=r}get key(){return this._key?Ci(this._key):""}set clientId(t){t&&(this._clientId=t)}get clientId(){let t=this._clientId;return t||(t=this._clientId=Ce()),this._clientId}set peerId(t){t&&(this._peerId=t)}get peerId(){return this._peerId}set clientMeta(t){}get clientMeta(){let t=this._clientMeta;return t||(t=this._clientMeta=tr()),t}set peerMeta(t){this._peerMeta=t}get peerMeta(){return this._peerMeta}set handshakeTopic(t){t&&(this._handshakeTopic=t)}get handshakeTopic(){return this._handshakeTopic}set handshakeId(t){t&&(this._handshakeId=t)}get handshakeId(){return this._handshakeId}get uri(){return this._formatUri()}set uri(t){if(!t)return;const{handshakeTopic:r,bridge:f,key:v}=this._parseUri(t);this.handshakeTopic=r,this.bridge=f,this.key=v}set chainId(t){this._chainId=t}get chainId(){return this._chainId}set networkId(t){this._networkId=t}get networkId(){return this._networkId}set accounts(t){this._accounts=t}get accounts(){return this._accounts}set rpcUrl(t){this._rpcUrl=t}get rpcUrl(){return this._rpcUrl}set connected(t){}get connected(){return this._connected}set pending(t){}get pending(){return!!this._handshakeTopic}get session(){return{connected:this.connected,accounts:this.accounts,chainId:this.chainId,bridge:this.bridge,key:this.key,clientId:this.clientId,clientMeta:this.clientMeta,peerId:this.peerId,peerMeta:this.peerMeta,handshakeId:this.handshakeId,handshakeTopic:this.handshakeTopic}}set session(t){t&&(this._connected=t.connected,this.accounts=t.accounts,this.chainId=t.chainId,this.bridge=t.bridge,this.key=t.key,this.clientId=t.clientId,this.clientMeta=t.clientMeta,this.peerId=t.peerId,this.peerMeta=t.peerMeta,this.handshakeId=t.handshakeId,this.handshakeTopic=t.handshakeTopic)}on(t,r){const f={event:t,callback:r};this._eventManager.subscribe(f)}off(t){this._eventManager.unsubscribe(t)}async createInstantRequest(t){this._key=await this._generateKey();const r=this._formatRequest({method:"wc_instantRequest",params:[{peerId:this.clientId,peerMeta:this.clientMeta,request:this._formatRequest(t)}]});this.handshakeId=r.id,this.handshakeTopic=Ce(),this._eventManager.trigger({event:"display_uri",params:[this.uri]}),this.on("modal_closed",()=>{throw new Error(dr)});const f=()=>{this.killSession()};try{const v=await this._sendCallRequest(r);return v&&f(),v}catch(v){throw f(),v}}async connect(t){if(!this._qrcodeModal)throw new Error(yn);return this.connected?{chainId:this.chainId,accounts:this.accounts}:(await this.createSession(t),new Promise(async(r,f)=>{this.on("modal_closed",()=>f(new Error(dr))),this.on("connect",(v,c)=>{if(v)return f(v);r(c.params[0])})}))}async createSession(t){if(this._connected)throw new Error(Ue);if(this.pending)return;this._key=await this._generateKey();const r=this._formatRequest({method:"wc_sessionRequest",params:[{peerId:this.clientId,peerMeta:this.clientMeta,chainId:t&&t.chainId?t.chainId:null}]});this.handshakeId=r.id,this.handshakeTopic=Ce(),this._sendSessionRequest(r,"Session update rejected",{topic:this.handshakeTopic}),this._eventManager.trigger({event:"display_uri",params:[this.uri]})}approveSession(t){if(this._connected)throw new Error(Ue);this.chainId=t.chainId,this.accounts=t.accounts,this.networkId=t.networkId||0,this.rpcUrl=t.rpcUrl||"";const r={approved:!0,chainId:this.chainId,networkId:this.networkId,accounts:this.accounts,rpcUrl:this.rpcUrl,peerId:this.clientId,peerMeta:this.clientMeta},f={id:this.handshakeId,jsonrpc:"2.0",result:r};this._sendResponse(f),this._connected=!0,this._setStorageSession(),this._eventManager.trigger({event:"connect",params:[{peerId:this.peerId,peerMeta:this.peerMeta,chainId:this.chainId,accounts:this.accounts}]})}rejectSession(t){if(this._connected)throw new Error(Ue);const r=t&&t.message?t.message:un,f=this._formatResponse({id:this.handshakeId,error:{message:r}});this._sendResponse(f),this._connected=!1,this._eventManager.trigger({event:"disconnect",params:[{message:r}]}),this._removeStorageSession()}updateSession(t){if(!this._connected)throw new Error(se);this.chainId=t.chainId,this.accounts=t.accounts,this.networkId=t.networkId||0,this.rpcUrl=t.rpcUrl||"";const r={approved:!0,chainId:this.chainId,networkId:this.networkId,accounts:this.accounts,rpcUrl:this.rpcUrl},f=this._formatRequest({method:"wc_sessionUpdate",params:[r]});this._sendSessionRequest(f,"Session update rejected"),this._eventManager.trigger({event:"session_update",params:[{chainId:this.chainId,accounts:this.accounts}]}),this._manageStorageSession()}async killSession(t){const r=t?t.message:"Session Disconnected",f={approved:!1,chainId:null,networkId:null,accounts:null},v=this._formatRequest({method:"wc_sessionUpdate",params:[f]});await this._sendRequest(v),this._handleSessionDisconnect(r)}async sendTransaction(t){if(!this._connected)throw new Error(se);const r=Ne(t),f=this._formatRequest({method:"eth_sendTransaction",params:[r]});return await this._sendCallRequest(f)}async signTransaction(t){if(!this._connected)throw new Error(se);const r=Ne(t),f=this._formatRequest({method:"eth_signTransaction",params:[r]});return await this._sendCallRequest(f)}async signMessage(t){if(!this._connected)throw new Error(se);const r=this._formatRequest({method:"eth_sign",params:t});return await this._sendCallRequest(r)}async signPersonalMessage(t){if(!this._connected)throw new Error(se);t=ar(t);const r=this._formatRequest({method:"personal_sign",params:t});return await this._sendCallRequest(r)}async signTypedData(t){if(!this._connected)throw new Error(se);const r=this._formatRequest({method:"eth_signTypedData",params:t});return await this._sendCallRequest(r)}async updateChain(t){if(!this._connected)throw new Error("Session currently disconnected");const r=this._formatRequest({method:"wallet_updateChain",params:[t]});return await this._sendCallRequest(r)}unsafeSend(t,r){return this._sendRequest(t,r),this._eventManager.trigger({event:"call_request_sent",params:[{request:t,options:r}]}),new Promise((f,v)=>{this._subscribeToResponse(t.id,(c,k)=>{if(c){v(c);return}if(!k)throw new Error(ln);f(k)})})}async sendCustomRequest(t,r){if(!this._connected)throw new Error(se);switch(t.method){case"eth_accounts":return this.accounts;case"eth_chainId":return Rr(this.chainId);case"eth_sendTransaction":case"eth_signTransaction":t.params&&(t.params[0]=Ne(t.params[0]));break;case"personal_sign":t.params&&(t.params=ar(t.params));break}const f=this._formatRequest(t);return await this._sendCallRequest(f,r)}approveRequest(t){if(le(t)){const r=this._formatResponse(t);this._sendResponse(r)}else throw new Error(dn)}rejectRequest(t){if(ve(t)){const r=this._formatResponse(t);this._sendResponse(r)}else throw new Error(pn)}transportClose(){this._transport.close()}async _sendRequest(t,r){const f=this._formatRequest(t),v=await this._encrypt(f),c=typeof(r==null?void 0:r.topic)<"u"?r.topic:this.peerId,k=JSON.stringify(v),C=typeof(r==null?void 0:r.forcePushNotification)<"u"?!r.forcePushNotification:Ki(f);this._transport.send(k,c,C)}async _sendResponse(t){const r=await this._encrypt(t),f=this.peerId,v=JSON.stringify(r);this._transport.send(v,f,!0)}async _sendSessionRequest(t,r,f){this._sendRequest(t,f),this._subscribeToSessionResponse(t.id,r)}_sendCallRequest(t,r){return this._sendRequest(t,r),this._eventManager.trigger({event:"call_request_sent",params:[{request:t,options:r}]}),this._subscribeToCallResponse(t.id)}_formatRequest(t){if(typeof t.method>"u")throw new Error(gn);return{id:typeof t.id>"u"?ji():t.id,jsonrpc:"2.0",method:t.method,params:typeof t.params>"u"?[]:t.params}}_formatResponse(t){if(typeof t.id>"u")throw new Error(mn);const r={id:t.id,jsonrpc:"2.0"};if(ve(t)){const f=Zi(t.error);return Object.assign(Object.assign(Object.assign({},r),t),{error:f})}else if(le(t))return Object.assign(Object.assign({},r),t);throw new Error(lr)}_handleSessionDisconnect(t){const r=t||"Session Disconnected";this._connected||(this._qrcodeModal&&this._qrcodeModal.close(),wr(er)),this._connected&&(this._connected=!1),this._handshakeId&&(this._handshakeId=0),this._handshakeTopic&&(this._handshakeTopic=""),this._peerId&&(this._peerId=""),this._eventManager.trigger({event:"disconnect",params:[{message:r}]}),this._removeStorageSession(),this.transportClose()}_handleSessionResponse(t,r){r?r.approved?(this._connected?(r.chainId&&(this.chainId=r.chainId),r.accounts&&(this.accounts=r.accounts),this._eventManager.trigger({event:"session_update",params:[{chainId:this.chainId,accounts:this.accounts}]})):(this._connected=!0,r.chainId&&(this.chainId=r.chainId),r.accounts&&(this.accounts=r.accounts),r.peerId&&!this.peerId&&(this.peerId=r.peerId),r.peerMeta&&!this.peerMeta&&(this.peerMeta=r.peerMeta),this._eventManager.trigger({event:"connect",params:[{peerId:this.peerId,peerMeta:this.peerMeta,chainId:this.chainId,accounts:this.accounts}]})),this._manageStorageSession()):this._handleSessionDisconnect(t):this._handleSessionDisconnect(t)}async _handleIncomingMessages(t){if(![this.clientId,this.handshakeTopic].includes(t.topic))return;let f;try{f=JSON.parse(t.payload)}catch{return}const v=await this._decrypt(f);v&&this._eventManager.trigger(v)}_subscribeToSessionRequest(){this._transport.subscribe(this.handshakeTopic)}_subscribeToResponse(t,r){this.on(`response:${t}`,r)}_subscribeToSessionResponse(t,r){this._subscribeToResponse(t,(f,v)=>{if(f){this._handleSessionResponse(f.message);return}le(v)?this._handleSessionResponse(r,v.result):v.error&&v.error.message?this._handleSessionResponse(v.error.message):this._handleSessionResponse(r)})}_subscribeToCallResponse(t){return new Promise((r,f)=>{this._subscribeToResponse(t,(v,c)=>{if(v){f(v);return}le(c)?r(c.result):c.error&&c.error.message?f(c.error):f(new Error(lr))})})}_subscribeToInternalEvents(){this.on("display_uri",()=>{this._qrcodeModal&&this._qrcodeModal.open(this.uri,()=>{this._eventManager.trigger({event:"modal_closed",params:[]})},this._qrcodeModalOptions)}),this.on("connect",()=>{this._qrcodeModal&&this._qrcodeModal.close()}),this.on("call_request_sent",(t,r)=>{const{request:f}=r.params[0];if(si()&&this._signingMethods.includes(f.method)){const v=vr(er);v&&(window.location.href=v.href)}}),this.on("wc_sessionRequest",(t,r)=>{t&&this._eventManager.trigger({event:"error",params:[{code:"SESSION_REQUEST_ERROR",message:t.toString()}]}),this.handshakeId=r.id,this.peerId=r.params[0].peerId,this.peerMeta=r.params[0].peerMeta;const f=Object.assign(Object.assign({},r),{method:"session_request"});this._eventManager.trigger(f)}),this.on("wc_sessionUpdate",(t,r)=>{t&&this._handleSessionResponse(t.message),this._handleSessionResponse("Session disconnected",r.params[0])})}_initTransport(){this._transport.on("message",t=>this._handleIncomingMessages(t)),this._transport.on("open",()=>this._eventManager.trigger({event:"transport_open",params:[]})),this._transport.on("close",()=>this._eventManager.trigger({event:"transport_close",params:[]})),this._transport.on("error",()=>this._eventManager.trigger({event:"transport_error",params:["Websocket connection failed"]})),this._transport.open()}_formatUri(){const t=this.protocol,r=this.handshakeTopic,f=this.version,v=encodeURIComponent(this.bridge),c=this.key;return`${t}:${r}@${f}?bridge=${v}&key=${c}`}_parseUri(t){const r=on(t);if(r.protocol===this.protocol){if(!r.handshakeTopic)throw Error("Invalid or missing handshakeTopic parameter value");const f=r.handshakeTopic;if(!r.bridge)throw Error("Invalid or missing bridge url parameter value");const v=decodeURIComponent(r.bridge);if(!r.key)throw Error("Invalid or missing key parameter value");const c=r.key;return{handshakeTopic:f,bridge:v,key:c}}else throw new Error(wn)}async _generateKey(){return this._cryptoLib?await this._cryptoLib.generateKey():null}async _encrypt(t){const r=this._key;return this._cryptoLib&&r?await this._cryptoLib.encrypt(t,r):null}async _decrypt(t){const r=this._key;return this._cryptoLib&&r?await this._cryptoLib.decrypt(t,r):null}_getStorageSession(){let t=null;return this._sessionStorage&&(t=this._sessionStorage.getSession()),t}_setStorageSession(){this._sessionStorage&&this._sessionStorage.setSession(this.session)}_removeStorageSession(){this._sessionStorage&&this._sessionStorage.removeSession()}_manageStorageSession(){this._connected?this._setStorageSession():this._removeStorageSession()}_registerPushServer(t){if(!t.url||typeof t.url!="string")throw Error("Invalid or missing pushServerOpts.url parameter value");if(!t.type||typeof t.type!="string")throw Error("Invalid or missing pushServerOpts.type parameter value");if(!t.token||typeof t.token!="string")throw Error("Invalid or missing pushServerOpts.token parameter value");const r={bridge:this.bridge,topic:this.clientId,type:t.type,token:t.token,peerName:"",language:t.language||""};this.on("connect",async(f,v)=>{if(f)throw f;if(t.peerMeta){const c=v.params[0].peerMeta.name;r.peerName=c}try{if(!(await(await fetch(`${t.url}/new`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(r)})).json()).success)throw Error("Failed to register in Push Server")}catch{throw Error("Failed to register in Push Server")}})}}function Bn(i){return de.getBrowerCrypto().getRandomValues(new Uint8Array(i))}const Br=256,Tr=Br,Tn=Br,Ht="AES-CBC",Fn=`SHA-${Tr}`,je="HMAC",Cn="encrypt",Nn="decrypt",qn="sign",Pn="verify";function Ln(i){return i===Ht?{length:Tr,name:Ht}:{hash:{name:Fn},name:je}}function Wn(i){return i===Ht?[Cn,Nn]:[qn,Pn]}async function Je(i,t=Ht){return de.getSubtleCrypto().importKey("raw",i,Ln(t),!0,Wn(t))}async function Un(i,t,r){const f=de.getSubtleCrypto(),v=await Je(t,Ht),c=await f.encrypt({iv:i,name:Ht},v,r);return new Uint8Array(c)}async function Dn(i,t,r){const f=de.getSubtleCrypto(),v=await Je(t,Ht),c=await f.decrypt({iv:i,name:Ht},v,r);return new Uint8Array(c)}async function jn(i,t){const r=de.getSubtleCrypto(),f=await Je(i,je),v=await r.sign({length:Tn,name:je},f,t);return new Uint8Array(v)}function Hn(i,t,r){return Un(i,t,r)}function zn(i,t,r){return Dn(i,t,r)}async function Fr(i,t){return await jn(i,t)}async function Cr(i){const t=(i||256)/8,r=Bn(t);return Ni(ye(r))}async function Nr(i,t){const r=he(i.data),f=he(i.iv),v=he(i.hmac),c=ae(v,!1),k=xr(r,f),C=await Fr(t,k),E=ae(C,!1);return jt(c)===jt(E)}async function Vn(i,t,r){const f=fe(De(t)),v=r||await Cr(128),c=fe(De(v)),k=ae(c,!1),C=JSON.stringify(i),E=Ri(C),P=await Hn(c,f,E),H=ae(P,!1),Rt=xr(P,c),kt=await Fr(f,Rt),j=ae(kt,!1);return{data:H,hmac:j,iv:k}}async function $n(i,t){const r=fe(De(t));if(!r)throw new Error("Missing key: required for decryption");if(!await Nr(i,r))return null;const v=he(i.data),c=he(i.iv),k=await zn(c,r,v),C=xi(k);let E;try{E=JSON.parse(C)}catch{return null}return E}const Kn=Object.freeze(Object.defineProperty({__proto__:null,decrypt:$n,encrypt:Vn,generateKey:Cr,verifyHmac:Nr},Symbol.toStringTag,{value:"Module"}));class es extends In{constructor(t,r){super({cryptoLib:Kn,connectorOpts:t,pushServerOpts:r})}}const Jn={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},qr={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},At={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Bt={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Dt={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class M{static getFirstMatch(t,r){const f=r.match(t);return f&&f.length>0&&f[1]||""}static getSecondMatch(t,r){const f=r.match(t);return f&&f.length>1&&f[2]||""}static matchAndReturnConst(t,r,f){if(t.test(r))return f}static getWindowsVersionName(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(t){const r=t.split(".").splice(0,2).map(f=>parseInt(f,10)||0);if(r.push(0),r[0]===10)switch(r[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(t){const r=t.split(".").splice(0,2).map(f=>parseInt(f,10)||0);if(r.push(0),!(r[0]===1&&r[1]<5)){if(r[0]===1&&r[1]<6)return"Cupcake";if(r[0]===1&&r[1]>=6)return"Donut";if(r[0]===2&&r[1]<2)return"Eclair";if(r[0]===2&&r[1]===2)return"Froyo";if(r[0]===2&&r[1]>2)return"Gingerbread";if(r[0]===3)return"Honeycomb";if(r[0]===4&&r[1]<1)return"Ice Cream Sandwich";if(r[0]===4&&r[1]<4)return"Jelly Bean";if(r[0]===4&&r[1]>=4)return"KitKat";if(r[0]===5)return"Lollipop";if(r[0]===6)return"Marshmallow";if(r[0]===7)return"Nougat";if(r[0]===8)return"Oreo";if(r[0]===9)return"Pie"}}static getVersionPrecision(t){return t.split(".").length}static compareVersions(t,r,f=!1){const v=M.getVersionPrecision(t),c=M.getVersionPrecision(r);let k=Math.max(v,c),C=0;const E=M.map([t,r],P=>{const H=k-M.getVersionPrecision(P),Rt=P+new Array(H+1).join(".0");return M.map(Rt.split("."),kt=>new Array(20-kt.length).join("0")+kt).reverse()});for(f&&(C=k-Math.min(v,c)),k-=1;k>=C;){if(E[0][k]>E[1][k])return 1;if(E[0][k]===E[1][k]){if(k===C)return 0;k-=1}else if(E[0][k]<E[1][k])return-1}}static map(t,r){const f=[];let v;if(Array.prototype.map)return Array.prototype.map.call(t,r);for(v=0;v<t.length;v+=1)f.push(r(t[v]));return f}static find(t,r){let f,v;if(Array.prototype.find)return Array.prototype.find.call(t,r);for(f=0,v=t.length;f<v;f+=1){const c=t[f];if(r(c,f))return c}}static assign(t,...r){const f=t;let v,c;if(Object.assign)return Object.assign(t,...r);for(v=0,c=r.length;v<c;v+=1){const k=r[v];typeof k=="object"&&k!==null&&Object.keys(k).forEach(E=>{f[E]=k[E]})}return t}static getBrowserAlias(t){return Jn[t]}static getBrowserTypeByAlias(t){return qr[t]||""}}const V=/version\/(\d+(\.?_?\d+)+)/i,Gn=[{test:[/googlebot/i],describe(i){const t={name:"Googlebot"},r=M.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/opera/i],describe(i){const t={name:"Opera"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe(i){const t={name:"Opera"},r=M.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe(i){const t={name:"Samsung Internet for Android"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/Whale/i],describe(i){const t={name:"NAVER Whale Browser"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe(i){const t={name:"MZ Browser"},r=M.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/focus/i],describe(i){const t={name:"Focus"},r=M.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/swing/i],describe(i){const t={name:"Swing"},r=M.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/coast/i],describe(i){const t={name:"Opera Coast"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(i){const t={name:"Opera Touch"},r=M.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe(i){const t={name:"Yandex Browser"},r=M.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe(i){const t={name:"UC Browser"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe(i){const t={name:"Maxthon"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/epiphany/i],describe(i){const t={name:"Epiphany"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/puffin/i],describe(i){const t={name:"Puffin"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe(i){const t={name:"Sleipnir"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe(i){const t={name:"K-Meleon"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe(i){const t={name:"WeChat"},r=M.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe(i){const t={name:/qqbrowserlite/i.test(i)?"QQ Browser Lite":"QQ Browser"},r=M.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe(i){const t={name:"Internet Explorer"},r=M.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe(i){const t={name:"Microsoft Edge"},r=M.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe(i){const t={name:"Microsoft Edge"},r=M.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe(i){const t={name:"Vivaldi"},r=M.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe(i){const t={name:"SeaMonkey"},r=M.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/sailfish/i],describe(i){const t={name:"Sailfish"},r=M.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,i);return r&&(t.version=r),t}},{test:[/silk/i],describe(i){const t={name:"Amazon Silk"},r=M.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/phantom/i],describe(i){const t={name:"PhantomJS"},r=M.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe(i){const t={name:"SlimerJS"},r=M.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(i){const t={name:"BlackBerry"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe(i){const t={name:"WebOS Browser"},r=M.getFirstMatch(V,i)||M.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/bada/i],describe(i){const t={name:"Bada"},r=M.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/tizen/i],describe(i){const t={name:"Tizen"},r=M.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe(i){const t={name:"QupZilla"},r=M.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe(i){const t={name:"Firefox"},r=M.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/electron/i],describe(i){const t={name:"Electron"},r=M.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe(i){const t={name:"Miui"},r=M.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/chromium/i],describe(i){const t={name:"Chromium"},r=M.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,i)||M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe(i){const t={name:"Chrome"},r=M.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/GSA/i],describe(i){const t={name:"Google Search"},r=M.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test(i){const t=!i.test(/like android/i),r=i.test(/android/i);return t&&r},describe(i){const t={name:"Android Browser"},r=M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe(i){const t={name:"PlayStation 4"},r=M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe(i){const t={name:"Safari"},r=M.getFirstMatch(V,i);return r&&(t.version=r),t}},{test:[/.*/i],describe(i){const t=/^(.*)\/(.*) /,r=/^(.*)\/(.*)[ \t]\((.*)/,v=i.search("\\(")!==-1?r:t;return{name:M.getFirstMatch(v,i),version:M.getSecondMatch(v,i)}}}],Zn=[{test:[/Roku\/DVP/],describe(i){const t=M.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,i);return{name:Bt.Roku,version:t}}},{test:[/windows phone/i],describe(i){const t=M.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,i);return{name:Bt.WindowsPhone,version:t}}},{test:[/windows /i],describe(i){const t=M.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,i),r=M.getWindowsVersionName(t);return{name:Bt.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(i){const t={name:Bt.iOS},r=M.getSecondMatch(/(Version\/)(\d[\d.]+)/,i);return r&&(t.version=r),t}},{test:[/macintosh/i],describe(i){const t=M.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,i).replace(/[_\s]/g,"."),r=M.getMacOSVersionName(t),f={name:Bt.MacOS,version:t};return r&&(f.versionName=r),f}},{test:[/(ipod|iphone|ipad)/i],describe(i){const t=M.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,i).replace(/[_\s]/g,".");return{name:Bt.iOS,version:t}}},{test(i){const t=!i.test(/like android/i),r=i.test(/android/i);return t&&r},describe(i){const t=M.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,i),r=M.getAndroidVersionName(t),f={name:Bt.Android,version:t};return r&&(f.versionName=r),f}},{test:[/(web|hpw)[o0]s/i],describe(i){const t=M.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,i),r={name:Bt.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(i){const t=M.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,i)||M.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,i)||M.getFirstMatch(/\bbb(\d+)/i,i);return{name:Bt.BlackBerry,version:t}}},{test:[/bada/i],describe(i){const t=M.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,i);return{name:Bt.Bada,version:t}}},{test:[/tizen/i],describe(i){const t=M.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,i);return{name:Bt.Tizen,version:t}}},{test:[/linux/i],describe(){return{name:Bt.Linux}}},{test:[/CrOS/],describe(){return{name:Bt.ChromeOS}}},{test:[/PlayStation 4/],describe(i){const t=M.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,i);return{name:Bt.PlayStation4,version:t}}}],Qn=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(i){const t=M.getFirstMatch(/(can-l01)/i,i)&&"Nova",r={type:At.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:At.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:At.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:At.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:At.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:At.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:At.tablet}}},{test(i){const t=i.test(/ipod|iphone/i),r=i.test(/like (ipod|iphone)/i);return t&&!r},describe(i){const t=M.getFirstMatch(/(ipod|iphone)/i,i);return{type:At.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:At.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:At.mobile}}},{test(i){return i.getBrowserName(!0)==="blackberry"},describe(){return{type:At.mobile,vendor:"BlackBerry"}}},{test(i){return i.getBrowserName(!0)==="bada"},describe(){return{type:At.mobile}}},{test(i){return i.getBrowserName()==="windows phone"},describe(){return{type:At.mobile,vendor:"Microsoft"}}},{test(i){const t=Number(String(i.getOSVersion()).split(".")[0]);return i.getOSName(!0)==="android"&&t>=3},describe(){return{type:At.tablet}}},{test(i){return i.getOSName(!0)==="android"},describe(){return{type:At.mobile}}},{test(i){return i.getOSName(!0)==="macos"},describe(){return{type:At.desktop,vendor:"Apple"}}},{test(i){return i.getOSName(!0)==="windows"},describe(){return{type:At.desktop}}},{test(i){return i.getOSName(!0)==="linux"},describe(){return{type:At.desktop}}},{test(i){return i.getOSName(!0)==="playstation 4"},describe(){return{type:At.tv}}},{test(i){return i.getOSName(!0)==="roku"},describe(){return{type:At.tv}}}],Xn=[{test(i){return i.getBrowserName(!0)==="microsoft edge"},describe(i){if(/\sedg\//i.test(i))return{name:Dt.Blink};const r=M.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,i);return{name:Dt.EdgeHTML,version:r}}},{test:[/trident/i],describe(i){const t={name:Dt.Trident},r=M.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test(i){return i.test(/presto/i)},describe(i){const t={name:Dt.Presto},r=M.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test(i){const t=i.test(/gecko/i),r=i.test(/like gecko/i);return t&&!r},describe(i){const t={name:Dt.Gecko},r=M.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:Dt.Blink}}},{test:[/(apple)?webkit/i],describe(i){const t={name:Dt.WebKit},r=M.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,i);return r&&(t.version=r),t}}];class pr{constructor(t,r=!1){if(t==null||t==="")throw new Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},r!==!0&&this.parse()}getUA(){return this._ua}test(t){return t.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const t=M.find(Gn,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(f=>this.test(f));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const t=M.find(Zn,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(f=>this.test(f));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os}getOSName(t){const{name:r}=this.getOS();return t?String(r).toLowerCase()||"":r||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(t=!1){const{type:r}=this.getPlatform();return t?String(r).toLowerCase()||"":r||""}parsePlatform(){this.parsedResult.platform={};const t=M.find(Qn,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(f=>this.test(f));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const t=M.find(Xn,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(f=>this.test(f));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return M.assign({},this.parsedResult)}satisfies(t){const r={};let f=0;const v={};let c=0;if(Object.keys(t).forEach(C=>{const E=t[C];typeof E=="string"?(v[C]=E,c+=1):typeof E=="object"&&(r[C]=E,f+=1)}),f>0){const C=Object.keys(r),E=M.find(C,H=>this.isOS(H));if(E){const H=this.satisfies(r[E]);if(H!==void 0)return H}const P=M.find(C,H=>this.isPlatform(H));if(P){const H=this.satisfies(r[P]);if(H!==void 0)return H}}if(c>0){const C=Object.keys(v),E=M.find(C,P=>this.isBrowser(P,!0));if(E!==void 0)return this.compareVersion(v[E])}}isBrowser(t,r=!1){const f=this.getBrowserName().toLowerCase();let v=t.toLowerCase();const c=M.getBrowserTypeByAlias(v);return r&&c&&(v=c.toLowerCase()),v===f}compareVersion(t){let r=[0],f=t,v=!1;const c=this.getBrowserVersion();if(typeof c=="string")return t[0]===">"||t[0]==="<"?(f=t.substr(1),t[1]==="="?(v=!0,f=t.substr(2)):r=[],t[0]===">"?r.push(1):r.push(-1)):t[0]==="="?f=t.substr(1):t[0]==="~"&&(v=!0,f=t.substr(1)),r.indexOf(M.compareVersions(c,f,v))>-1}isOS(t){return this.getOSName(!0)===String(t).toLowerCase()}isPlatform(t){return this.getPlatformType(!0)===String(t).toLowerCase()}isEngine(t){return this.getEngineName(!0)===String(t).toLowerCase()}is(t,r=!1){return this.isBrowser(t,r)||this.isOS(t)||this.isPlatform(t)}some(t=[]){return t.some(r=>this.is(r))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class rs{static getParser(t,r=!1){if(typeof t!="string")throw new Error("UserAgent should be a string");return new pr(t,r)}static parse(t){return new pr(t).getResult()}static get BROWSER_MAP(){return qr}static get ENGINE_MAP(){return Dt}static get OS_MAP(){return Bt}static get PLATFORMS_MAP(){return At}}export{rs as B,es as W};
