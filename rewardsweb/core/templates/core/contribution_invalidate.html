{% extends "base_generic.html" %}

{% block content %}
<div class="max-w-2xl mx-auto">
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      <h1 class="card-title text-2xl font-bold mb-6">Set contribution as {{ type }}</h1>
      
      <div class="bg-base-200 p-4 rounded-lg mb-6">
        <h2 class="font-semibold mb-2">Contribution Details:</h2>
        <p><strong>Contributor:</strong> {{ object.contributor }}</p>
        <p><strong>Cycle:</strong> {{ object.cycle }}</p>
        <p><strong>Platform:</strong> {{ object.platform }}</p>
        <p><strong>Reward:</strong> {{ object.reward }}</p>
        <p><strong>URL:</strong> <a href="{{ object.url }}" class="link link-accent" target="_blank">{{ object.url|truncatechars:50 }}</a></p>
      </div>

        <!-- Issue Body -->
        <div class="mt-6 pt-6">
          <h3 class="text-lg font-semibold mb-3">Original comment</h3>
          <div class="prose prose-sm max-w-none bg-base-200 rounded-lg p-4">
            {{ original_comment|linebreaks|urlize }}
          </div>
        </div>

      <form method="post">
        {% csrf_token %}
        
        {% if form.non_field_errors %}
        <div class="alert alert-error mb-4">
          {{ form.non_field_errors }}
        </div>
        {% endif %}

        <!-- Comment Field -->
        <div class="form-control w-full mt-4">
            <label class="label">
                <span class="label-text font-semibold">Reply (optional)</span>
            </label>
            <textarea name="comment" class="textarea textarea-bordered w-full h-32" 
                    placeholder="Enter reply to the original message here..."></textarea>
            {% if form.comment.errors %}
            <label class="label">
                <span class="label-text-alt text-error">
                    {% for error in form.comment.errors %}
                        {{ error }}
                    {% endfor %}
                </span>
            </label>
            {% endif %}
        </div>

        <!-- Form Actions -->
        <div class="flex gap-4">
          <button type="submit" class="btn btn-primary flex-1">
            Set as {{ type }}
          </button>
          <a href="{% url 'contribution_detail' object.pk %}" class="btn btn-outline flex-1">
            Cancel
          </a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}